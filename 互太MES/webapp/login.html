<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta http-equiv=“X-UA-Compatible” content=“chrome=1″ />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Document</title>
    <link rel="stylesheet" href="./plugins/layui/css/layui.css" media="all">
    <!--<link rel="stylesheet" type="text/css" href="http://www.jq22.com/jquery/font-awesome.4.6.0.css">-->
    <style>
        html,body{
            width: 100%;
            height: 100%;
        }
        i{
            color:red;
        }
        .loginBox{
            width: 700px;
            margin: 100px auto;
            border:1px solid #ccc;
            padding: 20px;
        }
        .loginBox > div{
            display: inline-block;
            padding-right:20px;
        }
        .loginText{
            display: inline-block;
            width: 125px;
        }
    </style>
</head>

<body>
    <div class="loginBox">
        <div>
            <img src="build/images/branding-image.jpg">
        </div>
        <div>
            <span class="loginText">$t("用戶")：</span>&nbsp<input type="text" id="loginUser"><i>*</i>
            <!-- <span class="loginText">用戶：</span>&nbsp<input type="text" id="loginUser"><i>*</i> -->
            <br><br>
            <span class="loginText">$t("密碼")：</span>&nbsp<input type="password" id="loginPassword"><i>*</i>
            <!-- <span class="loginText">密碼：</span>&nbsp<input type="password" id="loginPassword"><i>*</i> -->
            <br><br>
            <span class="loginText">$t("請選擇語言")：</span>
            <!-- <span class="loginText">請選擇語言：</span> -->
            <!-- <input type="radio" name="loginType" value="cn">繁体
            <input type="radio" name="loginType" value="en">English
            <input type="radio" name="loginType" value="vn">Việt Nam -->
            <select name="loginTypes" id="loginType">
                <option value="cn">繁体</option>
                <option value="en">English</option>
                <option value="vn">Việt Nam</option>
            </select>
            <br><br>
            <button onclick="login()">$t("登錄")</button>    
            <!-- <input type="file" id="fileupload" name="file" multiple="multiple" onchange="getIco(this.files)"/> -->
        </div>
    </div>
    
    
    <!-- <h1 onclick="window.location.href='index.html'">登录</h1>
    <div class="layui-container">
        
    </div> -->

    <script>
        // layui.config({
        //     base: 'js/'
        // }).use(function() {
        //     // var tab = layui.tab;
        //     // debugger;
        //     // if (tab.tabExists())
        //     //     tab.tabAdd();
        // });
    </script>
</body>
<!-- 转译 -->
<script src="build/js/di18n.js"></script>
<!-- <script src="build/js/di18n.min.js"></script> -->
<script src="build/js/lang.js"></script>
<!-- <script src="build/js/jsperanto.js"></script> -->
<!-- <script src="build/js/qunit.js"></script> -->

<script src="./plugins/layui/layui.js"></script>
<script type="text/javascript" src="plugins/layui/layuis.all.js"></script>
<!-- <script src="http://ajax.aspnetcdn.com/ajax/jquery/jquery-1.11.3.min.js"></script> -->
<script type="text/javascript" src="build/js/jquery.js" ></script>
<script type="text/javascript" src="plugins/servies.js" ></script>
<script>
    // $('#loginType')[0].options.add(new Option('test','321'))
    // strchangeL();
    if (sessionStorage.loginType) {
        $("input[name='loginType']").each(function(){
            if ($(this).val() == sessionStorage.loginType) {
                $(this)[0].checked = true;
            }
        })

        $("#loginType").val(sessionStorage.loginType);
    }
    //修改下拉框
    $("#loginType").on('change',function(){
        var clickLoginType = $("#loginType").val();
        sessionStorage.loginType = clickLoginType;
        window.location.reload();
    })

    //点击是动态修改编译参数
    $("input[name='loginType']").on('click',function(){
        var clickLoginType = $("input[name='loginType']:checked").val();
        sessionStorage.loginType = clickLoginType;
        window.location.reload();
    })

    //登录验证
    function login(){
        var loginUser = document.getElementById('loginUser').value;
        var loginPassword = $('#loginPassword').val();
        var loginType = $("input[name='loginType']:checked").val();
        if (loginUser == '') {
            // layer.alert('登录账号不能为空',{title:'提示'});
            alert('登录账号不能为空');
            return 
        }

        if (loginPassword == '') {
            // layer.alert('登录密码不能为空',{title:'提示'});
            alert('登录密码不能为空');
            return 
        }

        // sessionStorage.loginName = loginUser;
        // window.location.href='index.html';

        $.ajax({
            // url:'http://172.30.20.158:8080/mes/user/login',
            url:getAjaxURL('/user/login'),
            type:'POST',
            data:{
                userId:loginUser,
                password:loginPassword,
            },
            success:function(data){
                // console.log(data);
                if (data.status == 200) {
                    sessionStorage.loginName = loginUser;
                    window.location.href='index.html';
                } else {
                    alert(data.message);
                }
            },
            error:function(jqXHR, exception){
                // console.log(jqXHR);
                // console.log(jqXHR.responseText);
                // console.log(jqXHR.status);
                // console.log(jqXHR.readyState);
                // console.log(jqXHR.statusText);
                // console.log(exception);
                var msg = '';
                if (jqXHR.status === 0) {
                    msg = 'Not connect.\n Verify Network.';
                } else if (jqXHR.status == 404) {
                    msg = 'Requested page not found. [404]';
                } else if (jqXHR.status == 500) {
                    msg = 'Internal Server Error [500].';
                } else if (exception === 'parsererror') {
                    msg = 'Requested JSON parse failed.';
                } else if (exception === 'timeout') {
                    msg = 'Time out error.';
                } else if (exception === 'abort') {
                    msg = 'Ajax request aborted.';
                } else {
                    msg = 'Uncaught Error.\n' + jqXHR.responseText;
                }
                // console.log(msg);
                alert(msg);
            }
        })
    }
</script>
</html>