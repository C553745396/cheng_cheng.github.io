<!DOCTYPE html>
<html>

    <head>
        <meta charset="UTF-8">
        <title>緯編機台調校參數概覽</title>
        <meta name="renderer" content="webkit">
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
        <link rel="stylesheet" href="plugins/layui/css/layui.css" media="all" />
        <!-- <link rel="stylesheet" href="css/begtable.css" /> -->
        <!-- // <script type="text/javascript" src="build/js/printer.js"></script> -->
        <script type="text/javascript" src="plugins/servies.js" ></script>
    </head>

    <body>
        <div class="m" style="display:block;">
            <div class="top">
                <span>$t('緯編機台調校參數概覽')</span>
            </div>  
            <div class="">
                <span class="clearfix f">
                    <label class="layui-form-label">$t('物料号'):</label>
                    <div class="layui-input-inline">
                      <input type="test" name="password" required lay-verify="required" autocomplete="off" class="layui-input" id="obtain">
                    </div>
                </span>
                <span class="clearfix f">
                    <label class="layui-form-label">$t('机器种类'):</label>  <!-- Machine Type -->
                    <div class="layui-input-inline">
                      <input type="test" name="password" required lay-verify="required" autocomplete="off" class="layui-input" id="obtains">
                    </div>
                </span>
            </div>
            <br>
            
        </div>
        <div style="height:20px;"></div>
        <div style="margin:0 15px;">
            <table id="demo" lay-filter="test"></table>
            <i class="layui-icon" style="cursor:pointer" id="DeleteO">&#xe640;</i>
            <i class="layui-icon" style="cursor:pointer" id='heavyDuty'>&#x1002;</i>
        </div>
        <!-- // <script type="text/javascript" src="plugins/layui/layui.js"></script> -->
        <script type="text/javascript" src="plugins/layui/layuis.all.js"></script>
        <script type="text/javascript" src="plugins/layui/lay/modules/tables.js"></script>
        <script type="text/javascript" src="build/js/jquery.js" ></script>
        <script type="text/html" id="switchTpl">
          <input type="checkbox" name="checkbox" id="pay" lay-skin="primary" {{ d.stus1 == 1 ? 'checked' : '' }}>
        </script>
        <script type="text/html" id="switchTpl1">
          <input type="checkbox" name="sex" lay-skin="primary" {{ d.stus1 == 1 ? 'checked' : '' }}>
        </script>
        <script src="build/js/di18n.js"></script>
        <script src="build/js/lang.js"></script>
        <script>
            //多语言动态生成
            var colArr = [ //表头
                    {radio: true, LAY_CHECKED: false}
                    ,{field: 'clothingNo', title: '物料号', width:160}
                    ,{field: 'machineCategory', title: '机器种类', width:90}
                    ,{field: 'coilNo', title: '卷机号', width:80}
                    ,{field: 'totalPinNo', title: '总针数', width:80} 
                    ,{field: 'machineNo', title: '生产机号', width: 100}
                    ,{field: 'pinPerInch', title: '针长度', width: 80}
                    ,{field: 'waterLevel', title: '时间差 针织/G', width: 120}
                    ,{field: 'clothWidth', title: '布宽', width: 80}
                    ,{field: 'canHeight', title: '筒盘距', width: 80}

                    ,{field: 'rotationFreqPerPound', title: 'CROSSING单位', width:130}
                    ,{field:'sex', title:'已确认', templet: '#switchTpl'}
                    ,{field:'sex', title:'有化纖標識', width:105, templet: '#switchTpl1',}
                    ,{field: 'wpiStdL5', title: '标准WPI边5', width:120} /*1*/
                    ,{field: 'wpiStd', title: '标准WPI中', width: 120}
                    ,{field: 'wpiStdL10', title: '标准WPI边10', width: 120}
                    ,{field: 'cthllen', title: '布撑长度', width: 120}
                    ,{field: 'cthlwid', title: '布弓宽度', width: 120}   
                    ,{field: 'ctrcdep', title: '布弓深度', width: 120}

                    ,{field: 'ctrsg', title: '布棍齿', width:80}
                    ,{field: 'unwidth', title: '松布封度', width:120}
                    ,{field: 'spandexHeight', title: '纤维高', width:80} /*1*/
                    ,{field: 'nozzleHeight', title: '喂纱器高', width: 120}
                    ,{field: 'tension', title: '张力', width: 80}
                    ,{field: 'coarseAdjust', title: '粗调', width: 80}
                    ,{field: 'slideAdjust', title: '细调', width: 80}   /*1*/
                    ,{field: 'microAdjust', title: '微调', width: 80}

                    ,{field: 'clothHoldWpiLeft', title: '布撑CPI左', width:150}
                    ,{field: 'clothHoldWpiMiddle', title: '布撑CPI中', width:150}
                    ,{field: 'clothRollstickCpiRight', title: '布撑CPI右', width:150}
                    ,{field: 'clothRollstickCpiLeft', title: '卷布棍CPI左', width: 150}
                    ,{field: 'clothRollstickCpiMiddle', title: '卷布棍CPI中', width: 120}
                    ,{field: 'clothRollstickCpiRight', title: '卷布棍CPI右', width: 150}
                    ,{field: 'huckCpi', title: '松布CPI', width: 80}
                    ,{field: 'clothHoldWpiLeft', title: '布撑WPI左', width: 120}

                    ,{field: 'clothHoldWpiMiddle', title: '布撑WPI中', width:120}
                    ,{field: 'clothHoldWpiRight', title: '布撑WPI右', width:120}
                    ,{field: 'clothRollstickCpiLeft', title: '卷布棍WPI左', width:120}
                    ,{field: 'clothRollstickCpiMiddle', title: '卷布棍WPI中', width: 120}
                    ,{field: 'clothRollstickCpiRight', title: '卷布棍WPI右', width: 120}
                    ,{field: 'huckWpi', title: '松布WPI', width: 120}
                    ,{field: 'timClothNo', title: 'TIM布料编码', width: 120}
                    ,{field: 'clothFrameVersion', title: '布框版本', width: 120}

                    ,{field: 'reelYarnCyclomaticNo', title: 'Yarn revolution in Yarn magazine', width:200}
                    ,{field: 'reelYarnCyclomaticNo', title: '绒头长度', width:120}
                    ,{field: 'masterGear', title: '主齿轮', width:80}
                    ,{field: 'clothStickDriven', title: '卷布棍驱', width: 120}
                    ,{field: 'connectingLinkDriven', title: 'CONNECTING LINK_DRIVEN', width: 150}
                    ,{field: 'clothRollSurfaceCpi', title: '卷布表面CPI', width: 150}
                    ,{field: 'rotationFreqPerPound', title: '理论 RPM/LB值', width: 140}
                    ,{field: 'createduser', title: '创建人', width: 120}
                    ,{field: 'createddate', title: '创建时间', width: 165, templet: '<div>{{ layui.laytpl.toDateString(d.createddate) }}</div>'}
                    ,{field: 'lstupdateuser', title: '最近修改人', width: 120}
                    ,{field: 'lstupdatedate', title: '最近修改时间', width: 165, templet: '<div>{{ layui.laytpl.toDateString(d.lstupdatedate) }}</div>'}
                ];
            arrchangeL(colArr);
        </script>
        <script>
            var num,n,m,a1,a2,a3,a4,form,b1,b2,b3,b4,judge;
            var numKey;
            var add=[];
            var ad = new Array();
            layui.use(['table','layer','form','laytpl'], function(){
              var table = layui.table,                
                  layer = layui.layer,
                  form = layui.form,
                  laytpl = layui.laytpl;
              table.render({ 
                  elem: '#test'
              })
              //第一个实例
              table.render({
                  elem: '#demo'
                  ,height: 315
                  ,url: getAjaxURL('/weftKnittingMachineParaInfoOverview/getMachineParaInfoByMaterNum') //数据接口
                  // ,page: true //开启分页
                  ,response: {
                    statusName: 'status' //数据状态的字段名称，默认：code
                    ,statusCode: 0 //成功的状态码，默认：0
                    ,msgName: 'message' //状态信息的字段名称，默认：msg
                    ,countName: 'total' //数据总数的字段名称，默认：count
                    ,dataName: 'list' //
                  }
                  // ,where:{
                  //     txtClothingNo:""
                  // }
                  // ,limit:10
                  // ,limits:[10,20,50]
                  ,cols: [colArr]
                ,done: function(res, curr, count){
                  $('.layui-table-cell')[0].style.zIndex = '-2';
                  //如果是异步请求数据方式，res即为你接口返回的信息。
                  //如果是直接赋值的方式，res即为：{data: [], count: 99} data为当前页数据、count为数据总长度
                  console.log(123)
                  console.log(res);
                  
                  //得到当前页码
                  console.log(curr); 
                  
                  //得到数据总量
                  console.log(count);
                }
                ,id:'obtain1'
              });
              form.render();
              // 回车事件
                $('#obtain').keydown(function(event){
                	numKey=0;
                    if(event.keyCode == 13){
                        console.log($('#obtain').val())
                        table.reload('obtain1', {
                          url: getAjaxURL('/weftKnittingMachineParaInfoOverview/getMachineParaInfoByMaterNum')
                          ,where: {
                              txtClothingNo:$('#obtain').val()
                          } //设定异步数据接口的额外参数
                        });
                    }
                })
                $('#obtains').keydown(function(event){
                	numKey=1;
                    if(event.keyCode == 13){
                        console.log($('#obtains').val())
                        table.reload('obtain1', {
                          url: getAjaxURL('/weftKnittingMachineParaInfoOverview/getMachineParaInfoByMaterType')
                          ,where: {
                              machineType:$('#obtains').val()
                          } //设定异步数据接口的额外参数
                        });
                    }
                })
                // 删除一行
                $('#DeleteO').click(function(){
                    if(judge == true){
                        layer.open({
                          content: '你确定删除吗？'
                          ,area: ['300px', '180px']
                          ,title:'删除'
                          ,type:1
                          ,btn: ['删除', '取消'] //可以无限个按钮
                          ,yes: function(index, layero){
                              $.ajax({
                                url:getAjaxURL('/weftKnittingMachineParaInfoOverview/deleteMachineParaInfoByPrimary'),
                                data:{
                                  clothing_no:a1,
                                  machine_category:a2,
                                  coil_no:a3,
                                  total_pin_no:a4,
                                },
                                success:function(data){
                                    console.log(data)
                                    table.reload('obtain1', {
                                      url: getAjaxURL('/weftKnittingMachineParaInfoOverview/getMachineParaInfoByMaterNum')
                                      ,where: {
                                          txtClothingNo:""
                                      } //设定异步数据接口的额外参数
                                    });
                                    $('#obtains').val("")
                                    $('#obtain').val("")
                                    layer.closeAll();
                                }
                              })
                          }
                          ,btn2:function(){
                              layer.closeAll();
                          }
                        });
                    }else{
                        layer.alert('請選擇刪除行', {
                            title: "提示"
                        });
                    }
                })
                //选择单选框获取数据
                table.on('radio(test)', function(obj){
                    judge = obj.checked
                      console.log(obj.data)
                      a1 = obj.data.clothingNo;
                      a2 = obj.data.machineCategory;
                      a3 = obj.data.coilNo;
                      a4 = obj.data.totalPinNo;
                })
                            // 加载
                // function DeleteS(){
                $("#heavyDuty").click(function(){
                	if(numKey==0){
                		table.reload('obtain1', {
	                      url: getAjaxURL('/weftKnittingMachineParaInfoOverview/getMachineParaInfoByMaterNum')
	                    });
                	}else{
                		table.reload('obtain1', {
	                      url: getAjaxURL('/weftKnittingMachineParaInfoOverview/getMachineParaInfoByMaterType')
	                    });
                	}
                    
//                  $('#obtains').val("")
//                  $('#obtain').val("")
                });
            });
            
            
        </script>
        <script>
              //时间戳的处理
              layui.laytpl.toDateString = function(d, format){
                var date = new Date(d || new Date())
                ,ymd = [
                  this.digit(date.getFullYear(), 4)
                  ,this.digit(date.getMonth() + 1)
                  ,this.digit(date.getDate())
                ]
                ,hms = [
                  this.digit(date.getHours())
                  ,this.digit(date.getMinutes())
                  ,this.digit(date.getSeconds())
                ];

                format = format || 'yyyy-MM-dd HH:mm:ss';

                return format.replace(/yyyy/g, ymd[0])
                .replace(/MM/g, ymd[1])
                .replace(/dd/g, ymd[2])
                .replace(/HH/g, hms[0])
                .replace(/mm/g, hms[1])
                .replace(/ss/g, hms[2]);
              };
               
              //数字前置补零
              layui.laytpl.digit = function(num, length, end){
                var str = '';
                num = String(num);
                length = length || 2;
                for(var i = num.length; i < length; i++){
                  str += '0';
                }
                return num < Math.pow(10, length) ? str + (num|0) : num;
              };

        </script>
    </body>

</html>
<style scoped>
    .m{
        margin:0 15px;
    }
    *{
        margin: 0;
        padding: 0;
    }
    .top{
        height: 22px;
        line-height: 22px;
        font-size: 16px;
        border-bottom: 1px rgb(26,160,148) solid;
    }
    .layui-input{
        height: 25px;
    }
    .v_d{
        visibility:hidden;
    }
    .layui-input-inline{
        padding: 9px 0;
        width: 170px!important;
    }
    .layui-form-label{
        width: auto;
    }
    .clearfix:after{
        content: '';
        display: table;
        clear:both;
        visibility: hidden;
    }
    .f{
        float: left;
    }
    .c_p{
        cursor: pointer!important;
    }
</style>