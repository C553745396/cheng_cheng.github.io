<!DOCTYPE html>
<html>

    <head>
        <meta charset="utf-8">
        <title>整经盘头质检报工</title>
        <meta name="renderer" content="webkit">
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
        <meta name="apple-mobile-web-app-status-bar-style" content="black">
        <meta name="apple-mobile-web-app-capable" content="yes">
        <meta name="format-detection" content="telephone=no">

        <link rel="stylesheet" href="plugins/layui/css/layui.css" media="all" />
        <!--<link rel="stylesheet" type="text/css" href="http://www.jq22.com/jquery/font-awesome.4.6.0.css">-->
        <script src="build/js/dependencies/rsvp-3.1.0.min.js"></script>
        <script src="build/js/dependencies/sha-256.min.js"></script>
        <!-- <script type="text/javascript" src="build/js/qz-tray.js"></script> -->
        <!-- // <script src="https://js.fundebug.cn/fundebug.0.3.4.min.js" apikey="44ada0539edab21cf7b3c72319c8442ced64fecc396e1ea1b31363a3c95335b8"></script> -->
    </head>

    <body>
        <div class="m">
            <div class="top">
                <span>$t('整经盘头质检报工')</span>
                <!-- <span>整經盤頭質檢報工</span> -->
            </div>
            <div>
                <form class="layui-form" action="">
                <table border="1" cellspacing="0" bordercolor="#000000" style="border-collapse:collapse;" class="tdW">
                    <tr>
                        <td>$t('生産訂單號')</td>
                        <td><input type="text" value="" id="inp"></td>
                        <td>$t('盤頭物料號')</td>
                        <td colspan='2' id="txtBeamMaterial"><input value="" type="hidden"><span></span></td>
                        <td>$t('工作中心')</td>
                        <td colspan='2' id="txtWorkCenter"><input value="" type="hidden"><span></span></td>
                        <td>$t('盤頭型號')</td>
                        <td id="txtBeamType"><input disabled value="" type="hidden" id="txtBeamType"><span></span></td>
                    </tr>
                    <!-- 2 -->
                    <tr>
                        <td>$t('紗線物料號')</td>
                        <td id="eccYarnMaterial"><input type="hidden" value=""><span></span></td>
                        <td>$t('紗線批次號')</td>
                        <td colspan='2' id="eccYarnBatchNo"><input type="hidden" value=""><span></span></td>
                        <td>$t('紗商批次')</td>
                        <td colspan='2' id="eccYarnSupplierBatch"><input type="hidden" value=""><span></span></td>
                        <td>$t('盤頭個數')</td>
                        <td id="eccBeamQuantity"><input type="hidden" value=""><span></span></td>
                    </tr>
                    <!-- 3 -->
                    <tr>
                        <td>$t('紗線頭數')</td>
                        <td id="eccNumberEnds"><input type="text" value="" id="txtNumberEnds"></td>
                        <td>(m)$t('紗線要求米長')</td>
                        <td colspan='2' id="eccRequirerdLength"><input type="hidden" value=""><span></span></td>
                        <td>$t('上紗時間')</td>
                        <td colspan='2' id="eccGetYarnUpDate">
                        <input type="text" class="layui-input" id="txtGetYarnUpDate" value=""></td>
                        <td>$t('單/雙貼')&$t('穿紗方式')</td>
                        <td id="eccThreadingMethod"><input type="hidden" value=""><span></span></td>
                    </tr>
                    <!-- 4 -->
                    <tr>
                        <td>(mm)$t('盤頭內週')</td>
                        <td id="eccInnerCircumference"><input type="hidden" value=""><span></span></td>
                        <td>$t('非彈性紗張力')</td>
                        <td colspan='2' id="eccMachineTension"><input type="hidden" value=""><span></span></td>
                        <td>$t('彈性紗張力')(PIV)</td>
                        <td colspan='2'><input type="text" value="0" id="txtMachinePIVPosition"></td>
                        <td>$t('機速')(m/min)</td>
                        <td><input type="text" value="0" id="txtWarpingSpeed"></td>
                    </tr>
                    <!-- 第五行 -->
                    <tr>
                        <td>$t('整經開始時間')</td>
                        <td><input type="text" class="layui-input" id="txtJobStartingTime"></td>
                        <td>$t('整經結束時間')</td>
                        <td colspan='2'><input type="text" class="layui-input" id="txtJobEndingTime"></td>
                        <td>$t('紗線生産日期')</td>
                        <td colspan='2'>
                        <input type="text" value="" name="date3" id="txtLotProductionDate"></td>
                        <td>$t('毛羽靈敏度')</td>
                        <td><input type="text" value="0" id="txtHairinessSensitive"></td>
                    </tr>
                    <!-- 6 -->
                    <tr>
                        <td>Creel NO</td>
                        <td id="txtCreelNO"><input type="hidden" value=""><span></span></td>
                        <td>$t('彈性紗齒輪比')</td>
                        <td colspan='2'><input type="text" value="" id="txtRate" style="width:auto;"></td>
                        <td>$t('最終牽伸')</td>
                        <td colspan='2'><input type="text" value="0" id="txtLastDrawing"></td>
                        <td>(kg)$t('損耗')</td>
                        <td><input type="text" value="0" id="txtWastage"></td>
                    </tr>
                  </table>
                </form>
                <hr>
                <form action="">
                  <table border="1" cellspacing="0" bordercolor="#000000" style="border-collapse:collapse;" class="tdW2">
                    <tr>
                        <td colspan='2'>$t('盤頭序號')</td>
                        <td>
                            <input type="hidden" class="textbox" id="txtBeamDetailID1" name="txtBeamDetailID1" value="">
                            <input type="hidden" class="textbox" id="txtBeamIndex1" name="txtBeamIndex1" value="1">
                        1</td>
                        <td id="txtBeamIndex2">
                            <input type="hidden" class="textbox" id="txtBeamDetailID2" name="txtBeamDetailID2" value="">
                            <input type="hidden" class="textbox" id="txtBeamIndex2" name="txtBeamIndex2" value="2">
                        2</td>
                        <td id="txtBeamIndex3">
                            <input type="hidden" class="textbox" id="txtBeamDetailID3" name="txtBeamDetailID3" value="">
                            <input type="hidden" class="textbox" id="txtBeamIndex3" name="txtBeamIndex3" value="3">
                        3</td>
                        <td id="txtBeamIndex4">
                            <input type="hidden" class="textbox" id="txtBeamDetailID4" name="txtBeamDetailID4" value="">
                            <input type="hidden" class="textbox" id="txtBeamIndex4" name="txtBeamIndex4" value="4">
                        4</td>
                        <td id="txtBeamIndex5">
                            <input type="hidden" class="textbox" id="txtBeamDetailID5" name="txtBeamDetailID5" value="">
                            <input type="hidden" class="textbox" id="txtBeamIndex5" name="txtBeamIndex5" value="5">
                        5</td>
                        <td id="txtBeamIndex6">
                            <input type="hidden" class="textbox" id="txtBeamDetailID6" name="txtBeamDetailID6" value="">
                            <input type="hidden" class="textbox" id="txtBeamIndex6" name="txtBeamIndex6" value="6">
                        6</td>
                        <td id="txtBeamIndex7">
                            <input type="hidden" class="textbox" id="txtBeamDetailID7" name="txtBeamDetailID7" value="">
                            <input type="hidden" class="textbox" id="txtBeamIndex7" name="txtBeamIndex7" value="7">
                        7</td>
                        <td id="txtBeamIndex8">
                            <input type="hidden" class="textbox" id="txtBeamDetailID8" name="txtBeamDetailID8" value="">
                            <input type="hidden" class="textbox" id="txtBeamIndex8" name="txtBeamIndex8" value="8">
                        8</td>
                    </tr>
                    <!-- 8 -->
                    <tr>
                        <td colspan='2'>$t('盤頭條碼')</td>
                        <td><input type="text" value="" id="txtBeamCode1" name="beam1" class="beam1"></td>
                        <td><input type="text" value="" id="txtBeamCode2" name="beam2" class="beam2"></td>
                        <td><input type="text" value="" id="txtBeamCode3" name="beam3" class="beam3"></td>
                        <td><input type="text" value="" id="txtBeamCode4" name="beam4" class="beam4"></td>
                        <td><input type="text" value="" id="txtBeamCode5" name="beam5" class="beam5"></td>
                        <td><input type="text" value="" id="txtBeamCode6" name="beam6" class="beam6"></td>
                        <td><input type="text" value="" id="txtBeamCode7" name="beam7" class="beam7"></td>
                        <td><input type="text" value="" id="txtBeamCode8" name="beam8" class="beam8"></td>
                    </tr>
                    <!-- 9 -->
                    <tr>
                        <td colspan='2'>$t('盤頭編碼')</td>
                        <td><input type="text" value="" id="txtBeamNO1" name="beam1" class="beam1"></td>
                        <td><input type="text" value="" id="txtBeamNO2" name="beam2" class="beam2"></td>
                        <td><input type="text" value="" id="txtBeamNO3" name="beam3" class="beam3"></td>
                        <td><input type="text" value="" id="txtBeamNO4" name="beam4" class="beam4"></td>
                        <td><input type="text" value="" id="txtBeamNO5" name="beam5" class="beam5"></td>
                        <td><input type="text" value="" id="txtBeamNO6" name="beam6" class="beam6"></td>
                        <td><input type="text" value="" id="txtBeamNO7" name="beam7" class="beam7"></td>
                        <td><input type="text" value="" id="txtBeamNO8" name="beam8" class="beam8"></td>
                    </tr>
                    <!-- 10 -->
                    <tr>
                        <td colspan='2'>$t('盤頭操作者')</td>
                        <td><input type="text" value="" id="txtBeamOperator1" name="beam1" class="beam1"></td>
                        <td><input type="text" value="" id="txtBeamOperator2" name="beam2" class="beam2"></td>
                        <td><input type="text" value="" id="txtBeamOperator3" name="beam3" class="beam3"></td>
                        <td><input type="text" value="" id="txtBeamOperator4" name="beam4" class="beam4"></td>
                        <td><input type="text" value="" id="txtBeamOperator5" name="beam5" class="beam5"></td>
                        <td><input type="text" value="" id="txtBeamOperator6" name="beam6" class="beam6"></td>
                        <td><input type="text" value="" id="txtBeamOperator7" name="beam7" class="beam7"></td>
                        <td><input type="text" value="" id="txtBeamOperator8" name="beam8" class="beam8"></td>
                    </tr>
                    <!-- 11 -->
                    <tr>
                        <td colspan='2'>(min)$t('盤頭生産時間')</td>
                        <td><input type="text" value="" id="txtBeamProductTime1" name="beam1" class="beam1 bea1"></td>
                        <td><input type="text" value="" id="txtBeamProductTime2" name="beam2" class="beam2 bea2"></td>
                        <td><input type="text" value="" id="txtBeamProductTime3" name="beam3" class="beam3 bea3"></td>
                        <td><input type="text" value="" id="txtBeamProductTime4" name="beam4" class="beam4 bea4"></td>
                        <td><input type="text" value="" id="txtBeamProductTime5" name="beam5" class="beam5 bea5"></td>
                        <td><input type="text" value="" id="txtBeamProductTime6" name="beam6" class="beam6 bea6"></td>
                        <td><input type="text" value="" id="txtBeamProductTime7" name="beam7" class="beam7 bea7"></td>
                        <td><input type="text" value="" id="txtBeamProductTime8" name="beam8" class="beam8 bea8"></td>
                    </tr>
                    <!-- 12 -->
                    <tr>
                        <td colspan='2'>(m)$t('米長')</td>
                        <td><input type="text" value="" id="txtActualBeamLength1" name="beam1" class="beam1"></td>
                        <td><input type="text" value="" id="txtActualBeamLength2" name="beam2" class="beam2"></td>
                        <td><input type="text" value="" id="txtActualBeamLength3" name="beam3" class="beam3"></td>
                        <td><input type="text" value="" id="txtActualBeamLength4" name="beam4" class="beam4"></td>
                        <td><input type="text" value="" id="txtActualBeamLength5" name="beam5" class="beam5"></td>
                        <td><input type="text" value="" id="txtActualBeamLength6" name="beam6" class="beam6"></td>
                        <td><input type="text" value="" id="txtActualBeamLength7" name="beam7" class="beam7"></td>
                        <td><input type="text" value="" id="txtActualBeamLength8" name="beam8" class="beam8"></td>
                    </tr>
                    <!-- 13 -->
                    <tr>
                        <td colspan='2'>$t('轉數')</td>
                        <td><input type="text" value="" id="txtNumberOfWindings1" name="beam1" class="beam1"></td>
                        <td><input type="text" value="" id="txtNumberOfWindings2" name="beam2" class="beam2"></td>
                        <td><input type="text" value="" id="txtNumberOfWindings3" name="beam3" class="beam3"></td>
                        <td><input type="text" value="" id="txtNumberOfWindings4" name="beam4" class="beam4"></td>
                        <td><input type="text" value="" id="txtNumberOfWindings5" name="beam5" class="beam5"></td>
                        <td><input type="text" value="" id="txtNumberOfWindings6" name="beam6" class="beam6"></td>
                        <td><input type="text" value="" id="txtNumberOfWindings7" name="beam7" class="beam7"></td>
                        <td><input type="text" value="" id="txtNumberOfWindings8" name="beam8" class="beam8"></td>
                    </tr>
                    <!-- 14 -->
                    <tr>
                        <td colspan='2'>(mm)$t('顯示外周')</td>
                        <td><input type="text" value="" id="txtOuterCircumference1" name="beam1" class="beam1"></td>
                        <td><input type="text" value="" id="txtOuterCircumference2" name="beam2" class="beam2"></td>
                        <td><input type="text" value="" id="txtOuterCircumference3" name="beam3" class="beam3"></td>
                        <td><input type="text" value="" id="txtOuterCircumference4" name="beam4" class="beam4"></td>
                        <td><input type="text" value="" id="txtOuterCircumference5" name="beam5" class="beam5"></td>
                        <td><input type="text" value="" id="txtOuterCircumference6" name="beam6" class="beam6"></td>
                        <td><input type="text" value="" id="txtOuterCircumference7" name="beam7" class="beam7"></td>
                        <td><input type="text" value="" id="txtOuterCircumference8" name="beam8" class="beam8"></td>
                    </tr>
                    <!-- 15 -->
                    <tr>
                        <td colspan='2'>(mm)$t('實測外周')</td>
                        <td><input type="text" value="" id="txtMeasuredCircumference1" name="beam1" class="beam1"></td>
                        <td><input type="text" value="" id="txtMeasuredCircumference2" name="beam2" class="beam2"></td>
                        <td><input type="text" value="" id="txtMeasuredCircumference3" name="beam3" class="beam3"></td>
                        <td><input type="text" value="" id="txtMeasuredCircumference4" name="beam4" class="beam4"></td>
                        <td><input type="text" value="" id="txtMeasuredCircumference5" name="beam5" class="beam5"></td>
                        <td><input type="text" value="" id="txtMeasuredCircumference6" name="beam6" class="beam6"></td>
                        <td><input type="text" value="" id="txtMeasuredCircumference7" name="beam7" class="beam7"></td>
                        <td><input type="text" value="" id="txtMeasuredCircumference8" name="beam8" class="beam8"></td>
                    </tr>
                    <!-- 16 -->
                    <tr>
                        <td colspan='2'>$t('硬度')</td>
                        <td><input type="text" value="" id="txtHardness1" name="beam1" class="beam1"></td>
                        <td><input type="text" value="" id="txtHardness2" name="beam2" class="beam2"></td>
                        <td><input type="text" value="" id="txtHardness3" name="beam3" class="beam3"></td>
                        <td><input type="text" value="" id="txtHardness4" name="beam4" class="beam4"></td>
                        <td><input type="text" value="" id="txtHardness5" name="beam5" class="beam5"></td>
                        <td><input type="text" value="" id="txtHardness6" name="beam6" class="beam6"></td>
                        <td><input type="text" value="" id="txtHardness7" name="beam7" class="beam7"></td>
                        <td><input type="text" value="" id="txtHardness8" name="beam8" class="beam8"></td>
                    </tr>
                    <!-- 17 -->
                    <tr>
                        <td colspan='2'>$t('實測張力')</td>
                        <td><input type="text" value="" id="txtTention1" name="beam1" class="beam1"></td>
                        <td><input type="text" value="" id="txtTention2" name="beam2" class="beam2"></td>
                        <td><input type="text" value="" id="txtTention3" name="beam3" class="beam3"></td>
                        <td><input type="text" value="" id="txtTention4" name="beam4" class="beam4"></td>
                        <td><input type="text" value="" id="txtTention5" name="beam5" class="beam5"></td>
                        <td><input type="text" value="" id="txtTention6" name="beam6" class="beam6"></td>
                        <td><input type="text" value="" id="txtTention7" name="beam7" class="beam7"></td>
                        <td><input type="text" value="" id="txtTention8" name="beam8" class="beam8"></td>
                    </tr>
                    <!-- 18 -->
                    <tr>
                        <td colspan='2'>$t('毛羽')/$t('單個')</td>
                        <td><input type="text" value="" id="txtHairiness1" name="beam1" class="beam1"></td>
                        <td><input type="text" value="" id="txtHairiness2" name="beam2" class="beam2"></td>
                        <td><input type="text" value="" id="txtHairiness3" name="beam3" class="beam3"></td>
                        <td><input type="text" value="" id="txtHairiness4" name="beam4" class="beam4"></td>
                        <td><input type="text" value="" id="txtHairiness5" name="beam5" class="beam5"></td>
                        <td><input type="text" value="" id="txtHairiness6" name="beam6" class="beam6"></td>
                        <td><input type="text" value="" id="txtHairiness7" name="beam7" class="beam7"></td>
                        <td><input type="text" value="" id="txtHairiness8" name="beam8" class="beam8"></td>
                    </tr>
                    <!-- 19 -->
                    <tr>
                        <td colspan='2'>$t('停機次數')/$t('單個')</td>
                        <td><input type="text" value="" id="txtStopTime1" name="beam1" class="beam1"></td>
                        <td><input type="text" value="" id="txtStopTime2" name="beam2" class="beam2"></td>
                        <td><input type="text" value="" id="txtStopTime3" name="beam3" class="beam3"></td>
                        <td><input type="text" value="" id="txtStopTime4" name="beam4" class="beam4"></td>
                        <td><input type="text" value="" id="txtStopTime5" name="beam5" class="beam5"></td>
                        <td><input type="text" value="" id="txtStopTime6" name="beam6" class="beam6"></td>
                        <td><input type="text" value="" id="txtStopTime7" name="beam7" class="beam7"></td>
                        <td><input type="text" value="" id="txtStopTime8" name="beam8" class="beam8"></td>
                    </tr>
                    <!-- 20 -->
                    <tr>
                        <td colspan='2'>$t('斷紗次數')/$t('單個')</td>
                        <td><input type="text" value="" id="txtYarnBreakage1" name="beam1" class="beam1"></td>
                        <td><input type="text" value="" id="txtYarnBreakage2" name="beam2" class="beam2"></td>
                        <td><input type="text" value="" id="txtYarnBreakage3" name="beam3" class="beam3"></td>
                        <td><input type="text" value="" id="txtYarnBreakage4" name="beam4" class="beam4"></td>
                        <td><input type="text" value="" id="txtYarnBreakage5" name="beam5" class="beam5"></td>
                        <td><input type="text" value="" id="txtYarnBreakage6" name="beam6" class="beam6"></td>
                        <td><input type="text" value="" id="txtYarnBreakage7" name="beam7" class="beam7"></td>
                        <td><input type="text" value="" id="txtYarnBreakage8" name="beam8" class="beam8"></td>
                    </tr>
                    </table>
                </form>
                <hr>
                    <!-- 21 -->
                <form action="">
                  <table border="1" cellspacing="0" bordercolor="#000000" style="border-collapse:collapse;" class="tdW4">
                    <tr>
                        <td colspan='2'>$t('加油量')</td>
                        <td colspan='2'><input type="text" value="0" id="txtOil" class="init"></td>
                        <td>$t('橫移寬度')</td>
                        <td colspan='5'><input type="text" value="0" id="txtSideswayWidth" class="init"></td>
                    </tr>
                    <!-- 22 -->
                    <tr>
                        <td>$t('此組毛羽匯總')</td>
                        <td><input type="text" value="0" disabled="disabled" id="txtSumOfFilamentation" class="init"></td>
                        <td>$t('此組停機匯總')</td>
                        <td><input type="text" value="0" disabled="disabled" id="txtSumOfStopTimes" class="init"></td>
                        <td>$t('此組斷紗匯總')</td>
                        <td><input type="text" value="0" disabled="disabled" id="txtSumOfYarnBreakage" class="init"></td>
                        <td>$t('硬度平均值')</td>
                        <td><input type="text" value="0" disabled="disabled" id="txtAverageOfHardness" class="init"></td>
                        <td>$t('實測張力平均值')</td>
                        <td><input type="text" value="0" disabled="disabled" id="txtAverageOfTension" class="init"></td>
                    </tr>
                    <!-- 23 -->
                    <tr>
                        <td colspan='2'>(kg)$t('盤頭毛重')</td>
                        <td><input type="text" value="" id="txtGrossWeight1" class="beam1"></td>
                        <td><input type="text" value="" id="txtGrossWeight2" class="beam2"></td>
                        <td><input type="text" value="" id="txtGrossWeight3" class="beam3"></td>
                        <td><input type="text" value="" id="txtGrossWeight4" class="beam4"></td>
                        <td><input type="text" value="" id="txtGrossWeight5" class="beam5"></td>
                        <td><input type="text" value="" id="txtGrossWeight6" class="beam6"></td>
                        <td><input type="text" value="" id="txtGrossWeight7" class="beam7"></td>
                        <td><input type="text" value="" id="txtGrossWeight8" class="beam8"></td>
                    </tr>
                    <!-- 24 -->
                    <tr>
                        <td colspan='2'>(kg)$t('盤頭淨重')</td>
                        <td><input type="text" value="" disabled="disabled" id="txtNetWeight1" class="init"></td>
                        <td><input type="text" value="" disabled="disabled" id="txtNetWeight2" class="init"></td>
                        <td><input type="text" value="" disabled="disabled" id="txtNetWeight3" class="init"></td>
                        <td><input type="text" value="" disabled="disabled" id="txtNetWeight4" class="init"></td>
                        <td><input type="text" value="" disabled="disabled" id="txtNetWeight5" class="init"></td>
                        <td><input type="text" value="" disabled="disabled" id="txtNetWeight6" class="init"></td>
                        <td><input type="text" value="" disabled="disabled" id="txtNetWeight7" class="init"></td>
                        <td><input type="text" value="" disabled="disabled" id="txtNetWeight8" class="init"></td>
                    </tr>
                    <!-- 25 -->
                    <tr>
                        <td colspan='2'>$t('盤頭總重')</td>
                        <td><input type="text" value="0" disabled="disabled" id="txtBeamTotalWeight" class="init"></td>
                        <td>$t('紗線實際旦數')</td>
                        <td><input type="text" value="0" disabled="disabled" id="txtActualDenier" class="init"></td>
                        <td>$t('毛羽指數')</td>
                        <td><input type="text" value="0" disabled="disabled" id="txtHairinessRatio" class="init"></td>
                        <td>Length Ratio <br> Confirmation (<1.5%)</td>
                        <td colspan='2' id="eccLengthRatioConfirmation">
                            <input value="1" type="hidden">
                            <span></span>
                        </td>
                    </tr>
                    <!-- 26 -->
                    <tr>
                        <td>$t('工單備注')：</td>
                        <td colspan='9'><input type="text" value="11" disabled="disabled" id="txtOrderRemarks" style="width:95%" class="init"></td>
                    </tr>
                    <!-- 27 -->
                    <tr>
                        <td>$t('質檢備注')：</td>
                        <td colspan='9'><input type="text" value="" id="txtQualityRemarks" style="width:95%" class="init"></td>
                    </tr>
                    <!-- 28空行 -->
                    </table>
                </form>
                <hr>
                <form action="">
                  <table border="1" cellspacing="0" bordercolor="#000000" style="border-collapse:collapse;" class="tdW3">
                    <!-- 29 复选框-->
                    <tr>
                        <td>$t('開機確認項目')：</td>
                        <td colspan="9"></td>
                        <!-- <td rowspan='8'></td> -->
                    </tr>
                    <!-- 30-rowspan='2' -->
                    <tr>
                        <td colspan='2' rowspan='2'>$t('第一個盤頭')</td>
                        <td>$t('上紗頭數是否正確')</td>
                        <td>$t('紗路正確')</td>
                        <td>$t('紗架或木板無廢紗')</td>
                        <td>$t('分紗針無磨損')</td>
                        <td>$t('齒輪比是否正確')</td>
                        <td>$t('設置PIV')/$t('測紗線張力')</td>
                        <td>$t('參數輸入正確')</td>
                        <td>$t('確認人')</td>
                    </tr>
                    <tr>
                        <td><input name="Fruit" type="checkbox" value="" id="txtNoOfEnds1" class="check1 check11" /></td>
                        <td><input name="Fruit" type="checkbox" value="" id="txtTransport1" class="check1 check11" /></td>
                        <td><input name="Fruit" type="checkbox" value="" id="txtWasteYarn1" class="check1 check11" /></td>
                        <td><input name="Fruit" type="checkbox" value="" id="txtBroken1" class="check1 check11" /></td>
                        <td><input name="Fruit" type="checkbox" value="" id="txtGearRatio1" class="check1 check11" /></td>
                        <td><input name="Fruit" type="checkbox" value="" id="txtPIV1" class="check1 check11" /></td>
                        <td><input name="Fruit" type="checkbox" value="" id="txtParameter1" class="check1 check11" /></td>
                        <td rowspan='8'>
                            <!-- <form action="" onsubmit="return false;"> -->
                            <!-- <input type="text" style="display:none" /> -->
                                <input type="text" value="" id="txtConfirmer">
                                <!-- <button>确定</button> -->
                            <!-- </form> -->
                        </td>
                    </tr>
                    <!-- 31 -->
                    <tr>
                        <td colspan="2">$t('第二個盤頭')</td>
                        <td><input name="Fruit" type="checkbox" value="" id="txtNoOfEnds2" class="check2 check12" /></td>
                        <td><input name="Fruit" type="checkbox" value="" id="txtTransport2" class="check2 check12" /></td>
                        <td><input name="Fruit" type="checkbox" value="" id="txtWasteYarn2" class="check2 check12" /></td>
                        <td><input name="Fruit" type="checkbox" value="" id="txtBroken2" class="check2 check12" /></td>
                        <td><input name="Fruit" type="checkbox" value="" id="txtGearRatio2" class="check2 check12" /></td>
                        <td><input name="Fruit" type="checkbox" value="" id="txtPIV2" class="check2 check12" /></td>
                        <td><input name="Fruit" type="checkbox" value="" id="txtParameter2" class="check2 check12" /></td>
                    </tr>
                    <!-- 32 -->
                    <tr>
                        <td colspan="2">$t('第三個盤頭')</td>
                        <td><input name="Fruit" type="checkbox" value="" id="txtNoOfEnds3" class="check3 check13" /></td>
                        <td><input name="Fruit" type="checkbox" value="" id="txtTransport3" class="check3 check13" /></td>
                        <td><input name="Fruit" type="checkbox" value="" id="txtWasteYarn3" class="check3 check13" /></td>
                        <td><input name="Fruit" type="checkbox" value="" id="txtBroken3" class="check3 check13" /></td>
                        <td><input name="Fruit" type="checkbox" value="" id="txtGearRatio3" class="check3 check13" /></td>
                        <td><input name="Fruit" type="checkbox" value="" id="txtPIV3" class="check3 check13" /></td>
                        <td><input name="Fruit" type="checkbox" value="" id="txtParameter3" class="check3 check13" /></td>
                    </tr>
                    <!-- 33 -->
                    <tr>
                        <td colspan="2">$t('第四個盤頭')</td>
                        <td><input name="Fruit" type="checkbox" value="" id="txtNoOfEnds4" class="check4 check14" /></td>
                        <td><input name="Fruit" type="checkbox" value="" id="txtTransport4" class="check4 check14" /></td>
                        <td><input name="Fruit" type="checkbox" value="" id="txtWasteYarn4" class="check4 check14" /></td>
                        <td><input name="Fruit" type="checkbox" value="" id="txtBroken4" class="check4 check14" /></td>
                        <td><input name="Fruit" type="checkbox" value="" id="txtGearRatio4" class="check4 check14" /></td>
                        <td><input name="Fruit" type="checkbox" value="" id="txtPIV4" class="check4 check14" /></td>
                        <td><input name="Fruit" type="checkbox" value="" id="txtParameter4" class="check4 check14" /></td>
                    </tr>
                    <!-- 34 -->
                    <tr>
                        <td colspan="2">$t('第五個盤頭')</td>
                        <td><input name="Fruit" type="checkbox" value="" id="txtNoOfEnds5" class="check5 check15" /></td>
                        <td><input name="Fruit" type="checkbox" value="" id="txtTransport5" class="check5 check15" /></td>
                        <td><input name="Fruit" type="checkbox" value="" id="txtWasteYarn5" class="check5 check15" /></td>
                        <td><input name="Fruit" type="checkbox" value="" id="txtBroken5" class="check5 check15" /></td>
                        <td><input name="Fruit" type="checkbox" value="" id="txtGearRatio5" class="check5 check15" /></td>
                        <td><input name="Fruit" type="checkbox" value="" id="txtPIV5" class="check5 check15" /></td>
                        <td><input name="Fruit" type="checkbox" value="" id="txtParameter5" class="check5 check15" /></td>
                    </tr>
                    <!-- 35 -->
                    <tr>
                        <td colspan="2">$t('第六個盤頭')</td>
                        <td><input name="Fruit" type="checkbox" value="" id="txtNoOfEnds6" class="check6 check16" /></td>
                        <td><input name="Fruit" type="checkbox" value="" id="txtTransport6" class="check6 check16" /></td>
                        <td><input name="Fruit" type="checkbox" value="" id="txtWasteYarn6" class="check6 check16" /></td>
                        <td><input name="Fruit" type="checkbox" value="" id="txtBroken6" class="check6 check16" /></td>
                        <td><input name="Fruit" type="checkbox" value="" id="txtGearRatio6" class="check6 check16" /></td>
                        <td><input name="Fruit" type="checkbox" value="" id="txtPIV6" class="check6 check16" /></td>
                        <td><input name="Fruit" type="checkbox" value="" id="txtParameter6" class="check6 check16" /></td>
                    </tr>
                    <!-- 36 -->
                    <tr>
                        <td colspan="2">$t('第七個盤頭')</td>
                        <td><input name="Fruit" type="checkbox" value="" id="txtNoOfEnds7" class="check7 check17" /></td>
                        <td><input name="Fruit" type="checkbox" value="" id="txtTransport7" class="check7 check17" /></td>
                        <td><input name="Fruit" type="checkbox" value="" id="txtWasteYarn7" class="check7 check17" /></td>
                        <td><input name="Fruit" type="checkbox" value="" id="txtBroken7" class="check7 check17" /></td>
                        <td><input name="Fruit" type="checkbox" value="" id="txtGearRatio7" class="check7 check17" /></td>
                        <td><input name="Fruit" type="checkbox" value="" id="txtPIV7" class="check7 check17" /></td>
                        <td><input name="Fruit" type="checkbox" value="" id="txtParameter7" class="check7 check17" /></td>
                    </tr>
                    <!-- 37 -->
                    <tr>
                        <td colspan="2">$t('第八個盤頭')</td>
                        <td><input name="Fruit" type="checkbox" value="" id="txtNoOfEnds8" class="check8 check18" /></td>
                        <td><input name="Fruit" type="checkbox" value="" id="txtTransport8" class="check8 check18" /></td>
                        <td><input name="Fruit" type="checkbox" value="" id="txtWasteYarn8" class="check8 check18" /></td>
                        <td><input name="Fruit" type="checkbox" value="" id="txtBroken8" class="check8 check18" /></td>
                        <td><input name="Fruit" type="checkbox" value="" id="txtGearRatio8" class="check8 check18" /></td>
                        <td><input name="Fruit" type="checkbox" value="" id="txtPIV8" class="check8 check18" /></td>
                        <td><input name="Fruit" type="checkbox" value="" id="txtParameter8" class="check8 check18" /></td>
                    </tr>
                </table>
                </form>
            </div>
            <div style='margin:10px 0;'>
                <button class="layui-btn layui-btn-small" id="keep">$t('暫存')</button>
                <button class="layui-btn layui-btn-small" id="job">$t('報工')</button>
                <button class="layui-btn layui-btn-small" id="stampTou">$t('打印整經盤頭票')</button>
                <button class="layui-btn layui-btn-small" id="stampSheet">$t('打印整經工單盤頭入倉單') </button>
            </div>
        </div>
        <input type="hidden" id="txtFINISHMARK" name="txtFINISHMARK" value="0"/>
        <input type="hidden" id="txtOperatonNO" name="txtOperatonNO" value=""/>
		<input type="hidden" id="txtBeamTypeID" name="txtBeamTypeID" value=""/>
		<input type="hidden" id="txtCreateBy" name="txtCreateBy" value=" a_test"/>
		<input type="hidden" id="txtCreateDate" name="txtCreateDate" value=""/>
        <script src="plugins/servies.js"></script>
        <script type="text/javascript" src="plugins/layui/layui.js"></script>
        <script type="text/javascript" src="plugins/layui/layui.all.js"></script>
        <script src="build/js/jquery.js"></script>
        <!-- <script src="http://ajax.aspnetcdn.com/ajax/jquery/jquery-1.11.3.min.js"></script> -->
        <script src="build/js/di18n.js"></script>
        <script src="build/js/lang.js"></script>
        <script>
            layui.use(['form', 'layedit', 'laydate','layer'], function() {
                var form = layui.form,
                    layer = layui.layer,
                    layedit = layui.layedit,
                    laydate = layui.laydate;

                    laydate.render({
                        elem: '#txtJobStartingTime' //指定元素
                        ,type: 'datetime'
                    });
                    laydate.render({
                        elem: '#txtJobEndingTime' //指定元素
                        ,type: 'datetime'
                    });
                    laydate.render({
                        elem: '#txtLotProductionDate' //指定元素
                    });
                    laydate.render({
                        elem: '#txtGetYarnUpDate' //指定元素
                    });
                //创建一个编辑器
                var editIndex = layedit.build('LAY_demo_editor');
                //自定义验证规则
                form.verify({
                    title: function(value) {
                        if(value.length < 5) {
                            return '标题至少得5个字符啊';
                        }
                    },
                    pass: [/(.+){6,12}$/, '密码必须6到12位'],
                    content: function(value) {
                        layedit.sync(editIndex);
                    }
                });
                //监听提交
                form.on('submit(demo1)', function(data) {
                    layer.alert(JSON.stringify(data.field), {
                        title: '最终的提交信息'
                    })
                    return false;
                });
            });
        </script>
        <script>
            //var x、y、sun、sum、re1-、a-b-、t、weight、ziweight1、ziweight2、ziweight3、arr、oo、count4、count1、number2、vars
            //、periphery
            var inp,inplog,d,rows,tt,weight,t,count1,count2,count3,chec,number1,numberm1,Num,Numm,store,assignmentNum,periphery1=0,periphery2=0,periphery3=0,Job;
            var arr = [];
            var arrs = [];
            var arr2 = [];
            var storage = [];
            var storagem = [];
            var ee = 0;
            var count4 = 0;
            var hh = 0;
            var ff = 0;
            var loading1 = null;
            var loading2 = null;
            var loading3 = null;
            var ORDER_NO_MARK;
            var BEAM_MAX_NUMBER = 0;
            $(document).ready(function(){
                // 生产订单编号
                // 第四个表格输确认人名字，复选框全选
                // 获取当天时间
                var data = new Date();
                var createData = data.getFullYear()+'-'+(data.getMonth()+1<10?'0'+(data.getMonth()+1):data.getMonth()+1)+'-'+(data.getDate()<10?"0"+data.getDate():data.getDate());
                $("#txtConfirmer").keydown(function(e){
                    // if(e.preventDefault){
                    //      e.preventDefault();//阻止确认人编辑修改
                    //  }else{
                    //      window.event.returnValue = false;
                    //  }
                    if(e.keyCode == 13){
                        chec = parseFloat($("#eccBeamQuantity span").html())
                        for(var che=1;che<=chec;che++){
                            $(".check"+che).prop('checked',true);
                            $("#tdW3 tr").addClass('checkColor')
                        };
                    }
                });
		 
                //初始化
                function init(){
                    $('.beam1').attr('disabled',false).val('');
                    $('.beam2').attr('disabled',false).val('');
                    $('.beam3').attr('disabled',false).val('');
                    $('.beam4').attr('disabled',false).val('');
                    $('.beam5').attr('disabled',false).val('');
                    $('.beam6').attr('disabled',false).val('');
                    $('.beam7').attr('disabled',false).val('');
                    $('.beam8').attr('disabled',false).val('');
                    $('#txtRate').attr('disabled',false).val('');
                    $('#txtWastage').attr('disabled',false).val('');
                    $('#txtLastDrawing').attr('disabled',false).val('');
                    $('#txtMachinePIVPosition').attr('disabled',false).val('');
                    $('#txtWarpingSpeed').attr('disabled',false).val('');
                    $('#txtLotProductionDate').attr('disabled',false).val('');
                    $('#txtHairinessSensitive').attr('disabled',false).val('');
                    $('#txtNumberEnds').attr('disabled',false).val('');

                    $('.init').val('');
                };


                //生产订单号-->获取数据
                $('#inp').keydown(function(event){
                    if(event.keyCode == 13){
                    	BEAM_MAX_NUMBER=1;
                        //初始化
                        init();

                        console.log(localStorage.getItem(1))
                        loading1 = layer.load();   //正在加载中
                        inp = document.getElementById('inp').value;
                        var time = new Date();
                        var year = time.getFullYear();
                        var month = time.getMonth() + 1;
                        var day = time.getDate();
                        if(month<10){
                            month='0'+month
                        };
                        if(day<10){
                            day='0'+day
                        };
                        dayTime = year+'-'+month+"-"+day;
                        document.getElementById("txtLotProductionDate").value = dayTime;
                        console.log("进入-----------------")
                        // console.log(localStorage.getItem())
                        $.ajax({
                            url:getAjaxURL('/BeamWarpingConf/getProdOrderDetail'),
                            data:{
                                OrderNo:inp
                            },
                            type:'POST',
                            success:function(data){
                                if (data.status == 200) {
                                    // inplog = inp;
                                    console.log("生产订单号-->获取数据------------------------------------")
                                    console.log(data)
                                    d = data.data;
                                    console.log(d)
                                    if(d.finish_MARK == 1){
                                        $(":input").attr("disabled",true);
                                        $('#inp').attr('disabled',false);
                                    }
                                    // 赋值
                                    Job = d.finish_MARK;
                                    console.log(Job)
                                    // 1
                                    $('#txtBeamMaterial span').html(d.beam_MATERIAL);
                                    $('#txtWorkCenter span').html(d.workcenter);
                                    $('#txtBeamType span').html(d.beam_TYPE);
                                    // 2
                                    $('#eccYarnMaterial span').html(d.yarn_MATERIAL);
                                    $('#eccYarnBatchNo span').html(d.yarn_BATCH_NO);
                                    $('#eccYarnSupplierBatch span').html(d.yarn_SUPPLIER_BATCH);
                                    $('#eccBeamQuantity span').html(d.beam_MAX_NUM);
                                    // 3
                                    $('#txtNumberEnds').val(d.number_ENDS);
                                    $('#eccRequirerdLength span').html(d.requirerd_LENGTH);
                                    $('#txtGetYarnUpDate').val(d.get_YRAN_UP_DATE);
                                    $('#eccThreadingMethod span').html(d.threading_METHOD);
                                    // 4
                                    // $('#eccInnerCircumference span').html(d.number_ENDS); //这个找不到 有逻辑
                                    // $('#eccInnerCircumference span').html(945); //这个找不到 有逻辑
                                    $('#eccMachineTension span').html(d.machine_TENSION);
                                    $('#txtMachinePIVPosition').val(d.machine_PIV_POSITION);
                                    $('#txtWarpingSpeed').val(d.warping_SPEED);
                                    // 6
                                    $('#txtCreelNO span').html(d.creel_NO);
                                    $('#txtRate').val(d.org_RATE);
                                    $('#txtLastDrawing').val(d.last_DRAWING);
                                    $('#txtWastage').val(d.wastage);
                                    
                                    $('#txtHairinessSensitive').val(d.hairiness_SENSITIVE)
                                    
                                    if(d.job_STARTING_TIME == null){
                                        $('#txtJobStartingTime').val("");
                                    }else{
                                        $('#txtJobStartingTime').val("20"+d.job_STARTING_TIME);
                                    };
                                    if(d.job_ENDING_TIME == null){
                                        $('#txtJobEndingTime').val("");
                                    }else{
                                        $('#txtJobEndingTime').val("20"+d.job_ENDING_TIME);
                                    };
                                    // 21
                                    $('#txtOil').val(d.oil);
                                    $('#txtSideswayWidth').val(d.sidesway_WIDTH);

                                    $('#txtBeamTotalWeight').val(d.beam_TOTAL_WEIGHT);
                                    $('#txtActualDenier').val(d.real_DENIER);
                                    $('#txtHairinessRatio').val(d.hairiness_RATIO);
                                    $('#txtRate').val(d.rate);

                                    $('#txtSumOfFilamentation').val(d.s_FILAMENTATION);  //22-1
                                    $('#txtSumOfStopTimes').val(d.s_STOP_TIMES);  //22-2
                                    $('#txtSumOfYarnBreakage').val(d.s_YARN_BREAKAGE);  //22-3
                                    $('#txtAverageOfHardness').val(d.a_HARDNESS);  //22-4
                                    $('#txtAverageOfTension').val(d.a_TENSION);  //22-5
                                    
                                    var y = parseFloat(d.beam_MAX_NUM) + 1;
                                    // 根据盘头个数禁用input第二个表格
                                    for(var x=y;x<=8;x++){
                                        $(".beam"+x).attr('disabled','disabled');
                                    };
                                    //根据盘头个数禁用checkbox第四个表格
                                    // 盘头个数赋值t
                                    t = parseFloat($("#eccBeamQuantity span").html());
                                    tt = t+1;
                                    for(var check = tt;check <= 8;check++){
                                        $(".check"+check).attr('disabled','disabled');
                                    };
                                    layer.close(loading1)   //取消加载
                                    storeUp(inp);   //暂存过的再次复制到页面
                                    // assignmentNums();    
                                } else {
                                    layer.closeAll();
                                    layer.alert(data.message);
                                    //输入框变回原来的
                                    // console.log(inp);
                                    // console.log(inplog);
                                    // document.getElementById('inp').value = inplog;
                                }
                                 //防止读取数据后，修改orderno
                                ORDER_NO_MARK = inp;
                            }
                        })
                    }
                });
                //暂存过的再次复制到页面
                function storeUp(inp){
                    $.ajax({
                        url:getAjaxURL('/BeamWarpingConf/getProdOrderDetailList'),
                        // anyse:false,
                        data:{
                            OrderNo:inp
                        },
                        success:function(data){
                            console.log("暂存赋值-----------------------------------------------")
                            console.log(data.data)
                            var vars = data.data;
                            var stores = parseFloat($("#eccBeamQuantity span").html());   //获取盘头个数
                            console.log(stores)

                            vars.forEach(function(item,idx){
                                console.log(123)
                                console.log(item)
                                // for(var i = 1;i <= vars.length;i++){
                                // console.log(vars)
                                // BEAM_DETAIL_ID   7-1
                                // BEAM_ID   7-1
                                var store = item.BEAM_ID;
                                console.log(store)

                                $('#txtBeamNO'+store).val(item.BEAM_NO)     //8-1
                                $('#txtBeamCode'+store).val(item.BEAM_CODE)     //9-1
                                $('#txtBeamOperator'+store).val(item.BEAM_OP)     //10-1
                                $('#txtBroken'+store).attr("checked",item.BROKEN==1?true:false)    //30-4
                                // CREATE_BY       //测试人员
                                // CREATE_DATE     //当天时间
                                $('#txtGearRatio'+store).attr("checked",item.GEAR_RATIO==1?true:false)    //30-5
                                $('#txtGrossWeight'+store).val(item.GROSS_WEIGHT)     //23-1
                                $('#txtNetWeight'+store).val(item.NET_WEIGHT)     //24-1
                                $('#txtNoOfEnds'+store).attr("checked",item.NO_OF_ENDS==1?true:false)    //30-1
                                $('#txtParameter'+store).attr("checked",item.PARAM==1?true:false)    //30-7
                                $('#txtPIV'+store).attr("checked",item.PIV==1?true:false)    //30-6
                                $('#inp').val(item.PRODUCTION_ORDER_NO)     //1-1
                                $('#txtTransport'+store).attr("checked",item.TRANSPORT==1?true:false)    //30-2
                                $('#txtWasteYarn'+store).attr("checked",item.WASTE_YARN==1?true:false)    //30-3
                                $('#txtActualBeamLength'+store).val(item.A_BEAM_LENGTH)     //12-1
                                $('#txtBeamProductTime'+store).val(item.BEAM_PRODUCT_TIME)     //11-1
                                $('#txtHairiness'+store).val(item.HAIRINESS)     //18-1
                                $('#txtHardness'+store).val(item.HARDNESS)     //16-1
                                $('#txtMeasuredCircumference'+store).val(item.MEASURED_CIRCUMFERENCE)     //15-1
                                $('#txtNetWeight'+store).val(item.NET_WEIGHT)     //24-1
                                $('#txtNumberOfWindings'+store).val(item.NUM_WINDINGS)     //13-1
                                $('#txtOuterCircumference'+store).val(item.OUTER_CIRCUMFERENCE)     //14-1
                                $('#txtStopTime'+store).val(item.STOP_TIME)     //19-1
                                $('#txtTention'+store).val(item.TENTION)     //17-1
                                $('#txtYarnBreakage'+store).val(item.YARN_BREAKAGE)     // 20-1
                                // {1-[(盘头内周+ 实测外周) X (转数求和)] / (2000 X 纱线头数)}
                                //arr[],初始控盘头重量，净重计算
                                $('#txtBeamCode'+store).blur();
                                $('#txtBeamNO'+store).blur();
                                // $('#txtNetWeight'+store).val($('#txtGrossWeight'+store).val()-arr[store]);
                                // };
                            })
                            console.log("执行完------------------------");
                            // assignmentNums()
                            //基本计算
                            ee = getEE();
                            ff = getFF();
                            hh = getHH();
                            
                        }
                    })
                };
                //暂存过的再次计算是否可以报工
                // function assignmentNums(){
                // // $("#stampTou").click(function(){

                // // })
                //     // {1-[(盘头内周+ 实测外周) X (转数求和)] / (2000 X 纱线头数)}
                //     console.log("再次计算")
                //     // console.log(parseFloat($('#eccInnerCircumference span').html()))    //盘头内周
                //     // console.log($('#eccBeamQuantity span').html())                      //盘头个数
                //     for(var periphery = 1;periphery <= parseFloat($('#eccBeamQuantity span').html());periphery++){
                //         periphery1 = parseFloat(periphery1) + parseFloat($('#txtMeasuredCircumference'+periphery).val())  //实测外周求和
                //     };
                //     for(var peripherys = 1;peripherys <= parseFloat($('#eccBeamQuantity span').html());peripherys++){
                //         periphery2 = parseFloat(periphery2) + parseFloat($('#txtNumberOfWindings'+peripherys).val())  //转数求和
                //     };
                //     periphery3 = 1-[(parseFloat($('#eccInnerCircumference span').html())+periphery1)*periphery2]/(2000*$("#txtNumberEnds").val())
                //     if(periphery3<0.015){ 
                //         $("#eccLengthRatioConfirmation span").html('OK');
                //         $("#job").attr("disabled",false)    //可以报工
                //     }else{
                //         $("#eccLengthRatioConfirmation span").html('NO');  //不可以报工
                //         $("#job").attr("disabled",false)
                //     }
                // };
                // });
                $('#keep').click(function(){
                    // 1
                    console.log($('#txtBeamMaterial span').html())  /*12*/
                    console.log($('#txtGetYarnUpDate').val())  /*33*/
                    console.log($('#txtMachinePIVPosition').val())  /*43*/
                    console.log($('#txtWarpingSpeed').val())  /*44*/
                    console.log($('#txtJobStartingTime').val())  /*51*/
                    console.log($('#txtJobEndingTime').val())  /*52*/
                    console.log($('#txtHairinessSensitive').val())  /*55*/
                    console.log($('#txtHairinessRatio').val())  /*25-3*/
                    console.log($('#txtWastage').val())  /*6-6*/
                    console.log($('#txtOil').val())  /*21-1*/
                    console.log($('#txtRate').val())  /*6-2*/
                    console.log($('#txtSideswayWidth').val())  /*21-2*/
                    console.log($('#txtSumOfFilamentation').val())  /*22-1*/
                    console.log($('#txtSumOfStopTimes').val())  /*22-2*/
                    console.log($('#txtSumOfYarnBreakage').val())  /*22-3*/
                    console.log($('#txtAverageOfHardness').val())  /*22-4*/
                    console.log($('#txtAverageOfTension').val())  /*22-5*/
                    console.log($('#txtBeamTotalWeight').val())  /*25-1*/
                    console.log($('#txtActualDenier').val())  /*25-2*/
                    console.log($('#txtLastDrawing').val())  /*6-3*/
                    console.log($('#txtLengthRatioConfirmation').val())  /*25-4*/
                    console.log($('#txtOrderRemarks').val())  /*26-1*/
                    console.log($('#txtQualityRemarks').val())  /*27-1*/
                });
                // 此处判断行-input框加限制条件
                //盤頭條碼
                for(var n = 1;n <= 8;n++){
                    $('#txtBeamCode'+n).blur(function(n){
                        return function(){
                            var canGet = true;
                            for(var i=1;i<=8;i++){
                                
                                if (i == n) {
                                    
                                    continue
                                }
                                if ($('#txtBeamCode'+i).val() == $('#txtBeamCode'+n).val() && $('#txtBeamCode'+n).val() != '') {
                                    $('#txtBeamCode'+n).val('');
                                    layer.alert('請輸入不同的盤頭', {title: "提示"});
                                    canGet = false;
                                    break
                                }
                            }
                            if (!canGet) {
                                return
                            }
                            if ($('#txtBeamCode'+n).val() != '') {
                                $.ajax({
                                    url:getAjaxURL('/BeamWarpingConf/getBeam'),
                                    data:{
                                        beamCode:$('#txtBeamCode'+n).val()
                                    },
                                    success:function(data){
                                        // console.log(data);
                                        if (data.status == 200) {
                                            if($('#txtBeamCode'+n).val()!==""){
                                                $('#txtBeamNO'+n).val(data.data.beamNo);
                                                // localStorage.setItem(n,data.data.id)
                                                arr2[n] = data.data.id;
                                                arr[n] = data.data.emBeamWeight;    //空盘头重量赋值、在下面有公式 净重=毛重-空盘头重量
                                                
                                                if (n == 1) {
                                                    //盘头内周
                                                    $.ajax({
                                                        url:getAjaxURL('/BeamWarpingConf/beamDetail'),
                                                        type:'POST',
                                                        data:{
                                                            beamDetailId1:arr2[1]
                                                        },
                                                        success:function(data){
                                                            $('#eccInnerCircumference span').html(data.data.innerCircumference);
                                                            //可否报工
                                                            canSend();
                                                        }
                                                    })
                                                }
                                                //对应修改
                                                $("#txtGrossWeight"+n).blur();
                                            }
                                        } else if(data.message == "参数不能为空"){

                                        } else {
                                            layer.alert(data.message, {
                                                title: "提示"
                                            });
                                        }
                                    }
                                })
                            } else{
                                arr[n] = '';
                                arr2[n] = '';
                            }
                        }
                    }(n))
                };
                //盤頭编碼
                for(var nn = 1;nn <= 8;nn++){
                    $('#txtBeamNO'+nn).blur(function(nn){
                        return function(){
                            var canGet = true;
                            for(var i=1;i<=8;i++){
                                
                                if (i == nn) {
                                    
                                    continue
                                }
                                if ($('#txtBeamNO'+i).val() == $('#txtBeamNO'+nn).val() && $('#txtBeamNO'+nn).val() != '') {
                                    $('#txtBeamNO'+nn).val('');
                                    layer.alert('請輸入不同的盤頭', {title: "提示"});
                                    canGet = false;
                                    break
                                }
                            }
                            if (!canGet) {
                                return
                            }
                            if($('#txtBeamNO'+nn).val()!==''){
                                $.ajax({
                                    url:getAjaxURL('/BeamWarpingConf/getBeam'),
                                    data:{
                                        beamNo:$('#txtBeamNO'+nn).val()
                                    },
                                    success:function(data){
                                        console.log(data);
                                        console.log('0----0')
                                        if (data.status == 200) {
                                            // localStorage.removeItem(nn)
                                            $('#txtBeamCode'+nn).val(data.data.beamCode)
                                            // localStorage.setItem(nn,data.data.id)
                                            arr2[nn] = data.data.id;
                                            arr[nn] = data.data.emBeamWeight;    //空盘头重量赋值、在下面有公式 净重=毛重-空盘头重量
                                            if (nn == 1) {
                                                //盘头内周
                                                $.ajax({
                                                    url:getAjaxURL('/BeamWarpingConf/beamDetail'),
                                                    type:'POST',
                                                    data:{
                                                        beamDetailId1:arr2[1]
                                                    },
                                                    success:function(data){
                                                        $('#eccInnerCircumference span').html(data.data.innerCircumference);
                                                        //可否报工
                                                        canSend();
                                                    }
                                                })
                                            }
                                            //对应修改
                                            $("#txtGrossWeight"+n).blur();
                                        } else if(data.message == "参数不能为空"){

                                        }else {
                                            layer.alert(data.message, {
                                                title: "提示"
                                            });
                                            $('#txtBeamNO'+nn).val('')
                                        }
                                    }
                                })
                            }else{
                                arr[nn] = '';
                                arr2[nn] = '';
                            }
                        }
                    }(nn))
                };
                // 盤頭生産時間/保留整数
                for(var z = 1;z <= 8;z++){
                    $('#txtBeamProductTime'+z).blur(function(z){
                        return function(){
                            if($('#txtBeamProductTime'+z).val()%1 === 0||$('#txtBeamProductTime'+z).val()==""){
                                // console.log(0)
                            }else{
                                layer.alert('请输入整数', {
                                    title: "提示"
                                });
                                $('#txtBeamProductTime'+z).val("")
                            }              
                        }
                    }(z))
                };
                // 米长/整数或2位小数
                for(var e = 1;e <= 8;e++){
                    $('#txtActualBeamLength'+e).blur(function(e){
                        return function(){
                            //是否是数字（注：下同）
                            if(!isNaN($('#txtActualBeamLength'+e).val())){  
                                //是否是整数或2位小数（注：下同）
                                if($('#txtActualBeamLength'+e).val()%1 === 0||$('#txtActualBeamLength'+e).val().toString().split(".")[1].length <= 2||$('#txtActualBeamLength'+e).val()==""){
                                    // 累加米长
                                    // ee = parseFloat(ee) + parseFloat($('#txtActualBeamLength'+e).val());
                                    ee = getEE();
                                    //纱线实际旦:数受米长之和影响
                                    getActualDenier();
                                    //毛羽指數:数受米长之和影响
                                    getHairinessRatio()
                                }else{
                                    layer.alert('请输入整数或2位小数', {
                                        title: "提示"
                                    });
                                    $('#txtActualBeamLength'+e).val("")
                                }
                            }else{
                                layer.alert('请输入整数或2位小数', {
                                    title: "提示"
                                });
                                $('#txtActualBeamLength'+e).val("")
                            }
                                          
                        }
                    }(e))
                };
                // 转数/整数
                for(var f = 1;f <= 8;f++){     
                    $('#txtNumberOfWindings'+f).blur(function(f){
                        return function(){
                            if($('#txtNumberOfWindings'+f).val()%1 === 0||$('#txtNumberOfWindings'+f).val()==""){
                                // ff = parseFloat(ff) + parseFloat($('#txtNumberOfWindings'+f).val())   //转数求和
                                ff = getFF();
                            }else{
                                layer.alert('请输入整数', {
                                    title: "提示"
                                });
                                $('#txtNumberOfWindings'+f).val("")
                            }              
                        }
                    }(f))
                };
                // 顯示外周/整数
                for(var g = 1;g <= 8;g++){     
                    $('#txtOuterCircumference'+g).blur(function(g){
                        return function(){
                            if(Number($('#txtOuterCircumference'+g).val()) && $('#txtOuterCircumference'+g).val() !=0 ||$('#txtOuterCircumference'+g).val()==""){
                                
                            }else{
                                layer.alert('请输入有效数字', {
                                    title: "提示"
                                });
                                $('#txtOuterCircumference'+g).val("")
                            }              
                        }
                    }(g))
                };
                // 實測外周/整数
                for(var h = 1;h <= 8;h++){     
                    $('#txtMeasuredCircumference'+h).blur(function(h){
                        return function(){
                            if(Number($('#txtMeasuredCircumference'+h).val()) && $('#txtMeasuredCircumference'+h).val() !=0 ||$('#txtOuterCircumference'+g).val()==""){    
                                // hh = parseFloat(hh) + parseFloat($('#txtMeasuredCircumference'+h).val());
                                hh = getHH();
                                
                            }else{
                                layer.alert('请输入有效数字', {
                                    title: "提示"
                                });
                                $('#txtMeasuredCircumference'+h).val("")
                            }              
                        }
                    }(h))
                };
                // 硬度/整数或1位小数
                for(var i = 1;i <= 8;i++){     
                    $('#txtHardness'+i).blur(function(i){
                        return function(){
                            if(!isNaN($('#txtHardness'+i).val())||$('#txtHardness'+i).val()==""){
                                // console.log($('#txtHardness'+i).val())
                                if($('#txtHardness'+i).val()%1 === 0||$('#txtHardness'+i).val().toString().split(".")[1].length == 1||$('#txtHardness'+i).val()==""){
                                    // 硬度平均值 数量和相加
                                    var suv = 0;
                                    for(var i1 = 1;i1 <= 8;i1++){
                                        var re2 = /^[0-9]+.?[0-9]*$/;
                                        if(!re2.test(parseInt($('#txtHardness'+i1).val()))){
                                            suv = suv+0;
                                        }else{
                                            suv = suv+parseInt($('#txtHardness'+i1).val());
                                        }
                                    };
                                    $("#txtAverageOfHardness").val(suv/t)
                                }else{
                                    layer.alert('请输入整数或1位小数', {
                                        title: "提示"
                                    });
                                    $('#txtHardness'+i).val("")
                                }
                            }else{
                                layer.alert('请输入整数或1位小数', {
                                    title: "提示"
                                });
                                $('#txtHardness'+i).val("")
                            }
                        }
                    }(i))
                };
                // 實測張力/整数或1位小数
                for(var j = 1;j <= 8;j++){     
                    $('#txtTention'+j).blur(function(j){
                        return function(){
                            if(!isNaN($('#txtTention'+j).val())||$('#txtTention'+j).val()==""){
                                if($('#txtTention'+j).val()%1 === 0||$('#txtTention'+j).val().toString().split(".")[1].length == 1||$('#txtTention'+j).val()==""){
                                    var suc = 0;
                                    for(var j1 = 1;j1 <= 8;j1++){
                                        var re2 = /^[0-9]+.?[0-9]*$/;
                                        if(!re2.test(parseInt($('#txtTention'+j1).val()))){
                                            suc = suc+0;
                                        }else{
                                            suc = suc+parseInt($('#txtTention'+j1).val());
                                        }
                                    };
                                    $("#txtAverageOfTension").val(suc/t)
                                }else{
                                    layer.alert('请输入整数或1位小数', {
                                        title: "提示"
                                    });
                                    $('#txtTention'+j).val("")
                                }
                            }else{
                                layer.alert('请输入整数或1位小数', {
                                    title: "提示"
                                });
                                $('#txtTention'+j).val("")
                            }              
                        }
                    }(j))
                };
                // 毛羽/單個/整数
                for(var k = 1;k <= 8;k++){     
                    $('#txtHairiness'+k).blur(function(k){
                        return function(){
                            if(!isNaN($('#txtHairiness'+k).val())||$('#txtHairiness'+k).val()==""){
                                if($('#txtHairiness'+k).val()%1 === 0||$('#txtHairiness'+k).val()==""){
                                    // 毛羽/單個 数量和相加
                                    var sun = 0;
                                    for(var k1 = 1;k1 <= 8;k1++){
                                        var re = /^[0-9]+.?[0-9]*$/;
                                        if(!re.test(parseFloat($('#txtHairiness'+k1).val()))){
                                            sun = sun+0;
                                        }else{
                                            sun = sun+parseFloat($('#txtHairiness'+k1).val());
                                        }
                                    }
                                    //毛羽总数 
                                    $("#txtSumOfFilamentation").val(sun)
                                    //毛羽指數:受此組毛羽總數影响
                                    getHairinessRatio()    
                                }else{
                                    layer.alert('请输入整数', {
                                        title: "提示"
                                    });
                                    $('#txtHairiness'+k).val("")
                                };
                            }else{
                                layer.alert('请输入整数', {
                                    title: "提示"
                                });
                                $('#txtHairiness'+k).val("")
                            }   
                        };
                    }(k));
                };
                // 停機次數/單個/整数
                for(var l = 1;l <= 8;l++){     
                    $('#txtStopTime'+l).blur(function(l){
                        return function(){
                            if(!isNaN($('#txtStopTime'+l).val())||$('#txtStopTime'+l).val()==""){
                                if($('#txtStopTime'+l).val()%1 === 0||$('#txtStopTime'+l).val()==""){
                                    // 停機次數/單個 数量和相加
                                    var sum = 0;
                                    for(var l1 = 1;l1 <= 8;l1++){
                                        var re1 = /^[0-9]+.?[0-9]*$/;
                                        if(!re1.test(parseInt($('#txtStopTime'+l1).val()))){
                                            sum = sum+0;
                                        }else{
                                            sum = sum+parseInt($('#txtStopTime'+l1).val());
                                        }
                                    } 
                                    $("#txtSumOfStopTimes").val(sum)
                                }else{
                                    layer.alert('请输入整数', {
                                        title: "提示"
                                    });
                                    $('#txtStopTime'+l).val("")
                                }  
                            }else{
                                layer.alert('请输入整数', {
                                    title: "提示"
                                });
                                $('#txtStopTime'+l).val("")
                            }          
                        }
                    }(l))
                };
                // 斷紗次數/單個/整数
                for(var m = 1;m <= 8;m++){     
                    $('#txtYarnBreakage'+m).blur(function(m){
                        return function(){
                            if(!isNaN($('#txtYarnBreakage'+m).val())||$('#txtYarnBreakage'+m).val()==""){
                                if($('#txtYarnBreakage'+m).val()%1 === 0||$('#txtYarnBreakage'+m).val()==""){
                                    // 停機次數/單個 数量和相加
                                    var sub = 0;
                                    for(var m1 = 1;m1 <= 8;m1++){
                                        var re1 = /^[0-9]+.?[0-9]*$/;
                                        if(!re1.test(parseInt($('#txtYarnBreakage'+m1).val()))){
                                            sub = sub+0;
                                        }else{
                                            sub = sub+parseInt($('#txtYarnBreakage'+m1).val());
                                        }
                                    } 
                                    $("#txtSumOfYarnBreakage").val(sub)
                                }else{
                                    layer.alert('请输入整数', {
                                        title: "提示"
                                    });
                                    $('#txtYarnBreakage'+m).val("")
                                }
                            }else{
                                layer.alert('请输入整数', {
                                    title: "提示"
                                });
                                $('#txtYarnBreakage'+m).val("")
                            }           
                        }
                    }(m))
                };
                //加油量
                // $('#txtOil').blur(function(){
                //     if(!isNaN($("#txtOil").val())||$('#txtOil').val()==""){
                //         if($('#txtOil').val()%1 === 0||$('#txtOil').val().toString().split(".")[1].length <= 2||$('#txtOil').val()==""){

                //         }else{
                //             layer.alert('请输入整数或2位小数', {
                //                 title: "提示"
                //             });
                //             $('#txtOil').val(0)
                //         }
                //     }else{
                //         layer.alert('请输入整数或2位小数', {
                //             title: "提示"
                //         });
                //         $('#txtOil').val(0)
                //     }
                // });
                //橫移寬度
                $('#txtSideswayWidth').blur(function(){
                    if(!isNaN($("#txtSideswayWidth").val())||$("#txtSideswayWidth").val()==""){
                        
                    }else{
                        layer.alert('请输入整数', {
                            title: "提示"
                        });
                        $('#txtSideswayWidth').val(0)
                    }
                });
                //盤頭毛重 
                for(var o = 1;o <= 8;o++){
                    $("#txtGrossWeight"+o).blur(function(o){
                        return function(){
                           
                            if ($('#txtGrossWeight'+o).val() == '') {
                                return
                            };
                            if($('#txtGrossWeight'+o).val()>arr[o]){
                                $('#txtNetWeight'+o).val(($('#txtGrossWeight'+o).val()-arr[o]).toFixed(2)); //净重=毛重-控盘头重量
                                // count4 = getTotalWeight();
                                // $("#txtBeamTotalWeight").val(parseFloat(count4));
                                // 纱线实际旦数：[(9000000 X 盘头总重) / (米长求和X 紗線頭數)]
                                //                             可变          可变
                                // count1 = (9000000*count4)/(ee*$('#txtNumberEnds').val());
                                // //毛羽指數(計算公式：此組毛羽總數/米长求和X* 紗線頭數/1000000）
                                // //                      可变              可变              可改
                                // count2 = (parseFloat($("#txtSumOfFilamentation").val()))/(ee*$('#txtNumberEnds').val()/1000000);
                                // $("#txtActualDenier").val(count1.toFixed(2));
                                // $("#txtHairinessRatio").val(count2.toFixed(2));
                                
                                getActualDenier();


                            }else{
                                layer.alert('盘头毛重必须大于盘头自重', {
                                    title: "提示"
                                });
                                $('#txtGrossWeight'+o).val("");   //清空盘头毛重
                                $('#txtNetWeight'+o).val("");   //清空盘头净重
                            }
                        }
                    }(o))
                };

                // 纱线实际旦数：[(9000000 X 盘头总重) / (米长求和X 紗線頭數)]
                //                             可变          可变      可改
                function getActualDenier(){
                    count4 = getTotalWeight();
                    count1 = (9000000*count4)/(ee*$('#txtNumberEnds').val());
                    // console.log('-----------------------------')
                    // console.log(count4);
                    // console.log(ee);
                    // console.log($('#txtNumberEnds').val());
                    // console.log('纱线实际旦数：'+count1.toFixed(2));
                    // console.log('-----------------------------')
                    if (!count1) {
                        $("#txtActualDenier").val('');
                        return
                    }
                    $("#txtActualDenier").val(count1.toFixed(2));

                }
                //毛羽指數(計算公式：此組毛羽總數/（所有盤頭的米長欄相加* 紗線頭數/1000000）
                //                      可变              可变              可改
                function getHairinessRatio(){
                    count2 = (parseFloat($("#txtSumOfFilamentation").val()))/(ee*$('#txtNumberEnds').val()/1000000);
                    // console.log('-----------------------------')
                    // console.log(parseFloat($("#txtSumOfFilamentation").val()));
                    // console.log(ee);
                    // console.log($('#txtNumberEnds').val())
                    // console.log('毛羽指數:'+count2.toFixed(2))
                    // console.log('-----------------------------')
                    if (!count2) {
                        $("#txtHairinessRatio").val('');
                        return
                    }
                    $("#txtHairinessRatio").val(count2.toFixed(2));
                }

                $('#txtNumberEnds').change(function(){
                    //毛羽指數 和 纱线实际旦数：受紗線頭數影响
                    getActualDenier();
                    getHairinessRatio();
                })

                //盘头总重
                function getTotalWeight(){
                    var total = 0;
                    for(var i = 1;i <= 8;i++){
                        // console.log(Number($('#txtNetWeight'+i).val()));
                        total += Number($('#txtNetWeight'+i).val());
                    }
                    console.log('盘头总重————————————————————')
                    console.log(total);
                    $("#txtBeamTotalWeight").val(total.toFixed(2));

                    return total
                };

                //ee  米长求和
                function getEE(){
                    var total = 0;
                    for(var i = 1;i <= 8;i++){
                        // console.log(Number($('#txtActualBeamLength'+i).val()));
                        total += Number($('#txtActualBeamLength'+i).val());
                    }
                    //可否报工
                    canSend();
                    console.log('米长');
                    console.log(total);
                    return total
                };

                //ff 转数求和
                function getFF(){
                    var total = 0;
                    for(var i = 1;i <= 8;i++){
                        // console.log(Number($('#txtNumberOfWindings'+i).val()));
                        total += Number($('#txtNumberOfWindings'+i).val());
                    }
                    //可否报工
                    canSend();
                    console.log('转数');
                    console.log(total);
                    return total
                };

                //hh 實測外周求和
                function getHH(){
                    var total = 0;
                    for(var i = 1;i <= 8;i++){
                        // console.log(Number($('#txtMeasuredCircumference'+i).val()));
                        total += Number($('#txtMeasuredCircumference'+i).val());
                    }
                    //可否报工
                    canSend();
                    console.log('實測外周');
                    console.log(total);
                    return total
                };

                //是否能报工<1.5%
                function canSend(){

                    // {1-[(盘头内周 + 实测外周求和) X (转数求和)] / (2000 X 纱线头数)}
                    //       不可改        可改           可改                 可改
                    // count3 = 1-(parseFloat($("#eccInnerCircumference span").html()) + hh)*ff/(2000*$("#txtNumberEnds").val());
                    // console.log('count3:');
                    // console.log(count3);
                    //判断Length Ratio Confirmation 是否小于0.015 
                    // if(count3<0.015){ 
                    //     $("#eccLengthRatioConfirmation span").html('OK');
                    //     $("#job").attr("disabled",false)    //可以报工
                    // }else{
                    //     $("#eccLengthRatioConfirmation span").html('NO');
                    //     $("#job").attr("disabled",true)
                    // }
                    
                    //原系统
                    // count3 = 1-(parseFloat($("#eccInnerCircumference span").html()) + hh)*ff/(2000*$("#txtNumberEnds").val());
                    // {1-[(盘头内周 + 实测外周求和) X (转数求和)] / (2000 X 米長求和)}
                    //       不可改        可改           可改                 可改
                   
                    // var a = parseFloat($("#eccBeamQuantity span").html());
                    // var nh = hh/a;
                    // var nf = ff/a;
                    // var ne = ee/a;
                   

                    // count3 = 1-(parseFloat($("#eccInnerCircumference span").html()) + hh)*ff/(2000*ee);
                    // count3 = 1-(parseFloat($("#eccInnerCircumference span").html()) + nh)*nf/(2000*ne);

                    // console.log('count3:');
                    // console.log(count3);
                    // console.log('实测外周求和----');
                    // console.log(hh)//1200
                    // console.log('转数求和----');
                    // console.log(ff)//1500
                    // console.log('米長求和----');
                    // console.log(ee)//1020
                    // console.log(1-(945 + nh)*nf/(2000*ne));
                    // console.log(1-(945 + hh)*ff/(2000*ee));

                    //原系统逻辑
                    // count3 = Math.abs(count3);
                    // if (false) {
                    // // if (count3 >= 0.03 || !count3) {
                    //     $("#eccLengthRatioConfirmation span").html("<font color='red'>No</font>");
                    //     $("#job").attr("disabled",true)
                    //     return false;
                    // } else {
                    //     $("#eccLengthRatioConfirmation span").html("<font color='green'>Yes</font>");
                    //     $("#job").attr("disabled",false) 
                    // }


                    var pnz = parseFloat($("#eccInnerCircumference span").html());
                    var idx = Number($("#eccBeamQuantity span").html());
                    console.log(idx)
                    for(i = 1;i<=idx;i++){
                        console.log('//////////////////')
                        //米长
                        var m = Number($('#txtActualBeamLength'+i).val());
                        console.log(m);
                        //转数
                        var z = Number($('#txtNumberOfWindings'+i).val());
                        console.log(z);
                        //外周
                        var w = Number($('#txtMeasuredCircumference'+i).val())
                        console.log(w);

                        var count3 = 1-(pnz + w)*z/(2000*m);
                        console.log(pnz)
                        console.log(count3);

                        console.log('/////////////////');
                        count3 = Math.abs(count3);
                        if (count3 >= 0.03 || !count3) {
                            $("#eccLengthRatioConfirmation span").html("<font color='red'>No</font>");
                            // $("#job").attr("disabled",true)
                            break
                        } else {
                            $("#eccLengthRatioConfirmation span").html("<font color='green'>Yes</font>");
                            $("#job").attr("disabled",false) 
                        }
                    }
                };

                // 第二个表格结束、第三个表格开始
                $('#txtOil').blur(function(){
                    if($('#txtOil').val()%1 === 0||$('#txtOil').val().toString().split(".")[1].length <= 2){
                        console.log(222)
                        console.log($('#txtOil').val())
                    }else{
                        layer.alert('请输入整数或保留2位小数', {
                            title: "提示"
                        });
                        $('#txtOil').val("")
                    }
                });
                // 橫移寬度
                $('#txtSideswayWidth').on('blur',function(){
                    if($('#txtSideswayWidth').val()%1 === 0){
                        console.log(222)
                        console.log($('#txtSideswayWidth').val())
                    }else{
                        layer.alert('请输入整数', {
                            title: "提示"
                        });
                        $('#txtSideswayWidth').val("")
                    }
                });
                
                // 暂存
                $('#keep').click(function(){
                	
                	
                	if (!$("#inp").val() || ORDER_NO_MARK != $("#inp").val()) {
		                layer.alert('請輸入正確的數據！');
		                return false;
		            }
		
		            if ($("#txtFINISHMARK").val() == 1) {
		                layer.alert('已報工，請勿重複操作！');
		                return false;
		            }
		            if (!BEAM_MAX_NUMBER) {
		                layer.alert('表單數據存在問題，請檢查後再操作！');
		                return false;
		            }
		
		            if (!checkBeamData()) {
		                layer.alert('盤頭不能重複選擇！');
		                return false;
		            }
//		            if (!checkInUsedBeam()) {
//		                return false;
//		            }
                	var currentDate = new Date();
		            $("#txtCreateDate").val(currentDate.getFullYear() + "-" + (currentDate.getMonth() + 1) + "-" + currentDate.getDate());
		            var oXmlL = null;
                	
                	
                    loading2 = layer.load();   //正在加载中
                    number1 = $("#eccBeamQuantity span").html();  //获取盘头个数
                    console.log("haode---------------------------------------------------")
                    // console.log($("#txtNoOfEnds1").is(":checked"))
                    //此循环里面是传到后台的值 详见下面 rows
//                  if(Job == 1){
//                      layer.alert('无法暂存', {
//                          title: "提示"
//                      });
//                      return false;
//                  };
//                  if(!$('#inp').val()){     //工单不能为空
//                      layer.alert('生産訂單號不能为空', {
//                          title: "提示"
//                      });
//                      return false
//                  };
//                  if(!$('#eccBeamQuantity span').html()){
//                      layer.alert('无法暂存', {
//                          title: "提示"
//                      });
//                      return false
//                  };
                    console.log("localStorage--这个很重要")
                    console.log(localStorage.getItem(1))
                    for(Num = 1;Num <= number1; Num++){
                        console.log(arr2[Num])
                        var number2 = {};
                        number2.PRODUCTION_ORDER_NO=$('#inp').val();  //1-1
                        number2.BEAM_ID=Num,  //7-1
                        number2.BEAM_OP=$('#txtBeamOperator'+Num).val(),  //10-1
                        number2.BEAM_PRODUCT_TIME=$('#txtBeamProductTime'+Num).val(),  //11-1
                        number2.A_BEAM_LENGTH=$('#txtActualBeamLength'+Num).val(),  //12-1

                        number2.NUM_WINDINGS=$('#txtNumberOfWindings'+Num).val(),  //13-1
                        number2.OUTER_CIRCUMFERENCE=$('#txtOuterCircumference'+Num).val(),  //14-1
                        number2.MEASURED_CIRCUMFERENCE=$('#txtMeasuredCircumference'+Num).val(),  //15-1
                        number2.HARDNESS=$('#txtHardness'+Num).val(),  //16-1
                        number2.TENTION=$('#txtTention'+Num).val(),  //17-1

                        number2.HAIRINESS=$('#txtHairiness'+Num).val(),  //18-1
                        number2.STOP_TIME=$('#txtStopTime'+Num).val(),  //19-1
                        number2.YARN_BREAKAGE=$('#txtYarnBreakage'+Num).val(),  //20-1
                        number2.BEAM_DETAIL_ID=arr2[Num]==undefined?"":arr2[Num],  //7-1
                        number2.GROSS_WEIGHT=$('#txtGrossWeight'+Num).val(),  //23-1

                        number2.NET_WEIGHT=$('#txtNetWeight1').val(),  //24-1
                        number2.CREATE_BY='test',
                        number2.CREATE_DATE=createData,
                        number2.NO_OF_ENDS=$("#txtNoOfEnds"+Num).is(":checked")==true?1:0,
                        number2.TRANSPORT=$("#txtTransport"+Num).is(":checked")==true?1:0,

                        number2.WASTE_YARN=$("#txtWasteYarn"+Num).is(":checked")==true?1:0,
                        number2.BROKEN=$("#txtBroken"+Num).is(":checked")==true?1:0,
                        number2.GEAR_RATIO=$("#txtGearRatio"+Num).is(":checked")==true?1:0,
                        number2.PIV=$("#txtPIV"+Num).is(":checked")==true?1:0,
                        number2.PARAM=$("#txtParameter"+Num).is(":checked")==true?1:0,
                        storage.push(number2)
                    }
                    console.log("暂存-----------------------------------")
                    console.log(arr2);
                    console.log(storage);

                    $.ajax({
                        url:getAjaxURL('/BeamWarpingConf/beamWarpingConfDraf'),
                        type:'POST',
                        data:{
                            // 主表
                            PRODUCTION_ORDER_NO:$('#inp').val(),  //1-1
                            GET_YRAN_UP_DATE:$('#txtGetYarnUpDate').val(),  //3-3
                            MACHINE_PIV_POSITION:$('#txtMachinePIVPosition').val(),  //4-3
                            WARPING_SPEED:$('#txtWarpingSpeed').val(),  //4-4
                            JOB_STARTING_TIME:$('#txtJobStartingTime').val(),  //5-1

                            JOB_ENDING_TIME:$('#txtJobEndingTime').val(),  //5-2
                            HAIRINESS_SENSITIVE:$('#txtHairinessSensitive').val(),  //5-5
                            HAIRINESS_RATIO:$('#txtHairinessRatio').val(),  //25-3
                            WASTAGE:$('#txtWastage').val(),  //6-6
                            OIL:$('#txtOil').val(),  //21-1

                            RATE:$('#txtRate').val(),  //6-2
                            SIDESWAY_WIDTH:$('#txtSideswayWidth').val(),  //21-2
                            S_FILAMENTATION:$('#txtSumOfFilamentation').val(),  //22-1
                            S_STOP_TIMES:$('#txtSumOfStopTimes').val(),  //22-2
                            S_YARN_BREAKAGE:$('#txtSumOfYarnBreakage').val(),  //22-3

                            A_HARDNESS:$('#txtAverageOfHardness').val(),  //22-4
                            A_TENSION:$('#txtAverageOfTension').val(),  //22-5
                            BEAM_TOTAL_WEIGHT:$('#txtBeamTotalWeight').val(),  //25-1
                            REAL_DENIER:$('#txtActualDenier').val(),  //25-2
                            LAST_DRAWING:$('#txtLastDrawing').val(),  //6-3

                            L_RATIO_CONFIRMATION:$('#txtLengthRatioConfirmation').val(),  //25-4
                            OR_REMARKS:$('#txtOrderRemarks').val(),  //26-1
                            QU_REMARKS:$('#txtQualityRemarks').val(),  //27-1 
                            CREATE_BY:'test',  //测试人员
                            // CREATE_DATE:'2018-01-10', //txtLotProductionDate
                            CREATE_DATE:$('#txtQualityRemarks').val(), //

                            CONFIRMER:$('#txtConfirmer').val(),  //复选框input
                            FINISH_MARK:0, //测试人员
                            LOT_PRODUCTION_DATE:$('#txtLotProductionDate').val(),  //5-3
                            rows:JSON.stringify(storage)
                        },
                        success:function(data){
                        	
                            console.log(data)
                            if(data.status == 200){
                            	Job=0;
                                layer.alert('暂存成功', {
                                    title: "提示"
                                });
                            }else if(data.message == "已报工"){
                                layer.alert('已报工', {
                                    title: "提示"
                                });
                            }else{
                                layer.alert('暂存失败', {
                                    title: "提示"
                                });
                            };
                            storage = [];
                            layer.close(loading2)   //取消加载
                        }
                    })
                });
				 //检查盘头可用性
		        function checkBeamData() {
		            var mark = true;
		            //jAlert(JSON.stringify($("input[id*=txtBeamNO]")));
		            $("input[id*=txtBeamNO]").each(function(index) {
		                //if($("#txtBeamOperator" + (index + 1)).val())
		                //jAlert($(this).val() + "====" + $("[id*=txtBeamNO][value=" + $(this).val() + "]").size());
		                var org = $(this).val();
		                if ($(this).val() && $("input[id*=txtBeamCode]").filter(function() {
		                    return $(this).val() == org;
		                }).size() > 1) {
		                    mark = false;
		                    return false;
		                }
		            });
		            return mark;
		        }
                // 报工
                $('#job').click(function(){
                    // console.log(123)
                    // // alert(123)
                    if(!$('#inp').val()){     //工单不能为空
                        layer.alert('生産訂單號不能为空', {
                            title: "提示"
                        });
                        return false
                    };
                    loading3 = layer.load();   //正在加载中
                    numberm1 = parseFloat($("#eccBeamQuantity span").html());  //获取盘头个数
                    var jobA = [];
                    console.log("点击报工---------------------------------")
                    Beam_In_Use_Check = "";
                    $("input[id*=txtBeamNO]").each(function() {
                        if ($(this).val()) {
                            jobA.push($(this).val());
                        }
                    });
                    if (jobA.length > 0) {
                        var condition = "BEAM_NO='";
                        condition += jobA.join("' or BEAM_NO='");
                        condition += "'";
                        Beam_In_Use_Check = condition;
                    };
                    console.log(Beam_In_Use_Check)
                    var jobB = $("input[id*=txtBeamNO]").map(function() {
                        if ($(this).val()) {
                            return $(this).val();
                        }
                    });
                    
                    console.log(jobB)
                    console.log(jobB.get().join())
                    console.log("baogong ===================")
                    console.log(Job)
                    // =1 不可以报工 =0 可以报工
                    if(parseFloat(Job) == 0){
                        console.log(count3)
                        console.log(periphery3)
                        if(count3<0.015||periphery3<0.015){
                            console.log("报工成功--------------------------")
                            // 此循环里面是传到后台的值 详见下面 rows
                            console.log(numberm1)
                            for(Numm = 1;Numm <= numberm1;Numm++){
                                var numberm2 = {};
                                numberm2.PRODUCTION_ORDER_NO=$('#inp').val();  //1-1
                                numberm2.BEAM_ID=Numm,  //7-1
                                numberm2.BEAM_OP=$('#txtBeamOperator'+Numm).val(),  //10-1
                                numberm2.BEAM_PRODUCT_TIME=$('#txtBeamProductTime'+Numm).val(),  //11-1
                                numberm2.A_BEAM_LENGTH=$('#txtActualBeamLength'+Numm).val(),  //12-1

                                numberm2.NUM_WINDINGS=$('#txtNumberOfWindings'+Numm).val(),  //13-1
                                numberm2.OUTER_CIRCUMFERENCE=$('#txtOuterCircumference'+Numm).val(),  //14-1
                                numberm2.MEASURED_CIRCUMFERENCE=$('#txtMeasuredCircumference'+Numm).val(),  //15-1
                                numberm2.HARDNESS=$('#txtHardness'+Numm).val(),  //16-1
                                numberm2.TENTION=$('#txtTention'+Numm).val(),  //17-1

                                numberm2.HAIRINESS=$('#txtHairiness'+Numm).val(),  //18-1
                                numberm2.STOP_TIME=$('#txtStopTime'+Numm).val(),  //19-1
                                numberm2.YARN_BREAKAGE=$('#txtYarnBreakage'+Numm).val(),  //20-1
                                numberm2.BEAM_DETAIL_ID=arr2[Numm]==undefined?"":arr2[Numm],  //7-1
                                numberm2.GROSS_WEIGHT=$('#txtGrossWeight'+Numm).val(),  //23-1

                                numberm2.NET_WEIGHT=$('#txtNetWeight1').val(),  //24-1
                                numberm2.CREATE_BY='test',
                                // numberm2.CREATE_BY= sessionStorage['loginName'],
                                numberm2.CREATE_DATE=createData,
                                numberm2.NO_OF_ENDS=$("#txtNoOfEnds"+Numm).is(":checked")==true?1:0,
                                numberm2.TRANSPORT=$("#txtTransport"+Numm).is(":checked")==true?1:0,

                                numberm2.WASTE_YARN=$("#txtWasteYarn"+Numm).is(":checked")==true?1:0,
                                numberm2.BROKEN=$("#txtBroken"+Numm).is(":checked")==true?1:0,
                                numberm2.GEAR_RATIO=$("#txtGearRatio"+Numm).is(":checked")==true?1:0,
                                numberm2.PIV=$("#txtPIV"+Numm).is(":checked")==true?1:0,
                                numberm2.PARAM=$("#txtParameter"+Numm).is(":checked")==true?1:0,
                                storagem.push(numberm2)
                                console.log(1)
                            };
                            console.log(storagem);
                            console.log(arr2)
                            // return
                            $.ajax({
                                url:getAjaxURL('/BeamWarpingConf/beamWarpingConfSave'),
                                type:'POST',
                                data:{
                                    // 主表
                                    PRODUCTION_ORDER_NO:$('#inp').val(),  //1-1
                                    GET_YRAN_UP_DATE:$('#txtGetYarnUpDate').val(),  //3-3
                                    MACHINE_PIV_POSITION:$('#txtMachinePIVPosition').val(),  //4-3
                                    WARPING_SPEED:$('#txtWarpingSpeed').val(),  //4-4
                                    JOB_STARTING_TIME:$('#txtJobStartingTime').val(),  //5-1

                                    JOB_ENDING_TIME:$('#txtJobEndingTime').val(),  //5-2
                                    HAIRINESS_SENSITIVE:$('#txtHairinessSensitive').val(),  //5-5
                                    HAIRINESS_RATIO:$('#txtHairinessRatio').val(),  //25-3
                                    WASTAGE:$('#txtWastage').val(),  //6-6
                                    OIL:$('#txtOil').val(),  //21-1

                                    RATE:$('#txtRate').val(),  //6-2
                                    SIDESWAY_WIDTH:$('#txtSideswayWidth').val(),  //21-2
                                    S_FILAMENTATION:$('#txtSumOfFilamentation').val(),  //22-1
                                    S_STOP_TIMES:$('#txtSumOfStopTimes').val(),  //22-2
                                    S_YARN_BREAKAGE:$('#txtSumOfYarnBreakage').val(),  //22-3

                                    A_HARDNESS:$('#txtAverageOfHardness').val(),  //22-4
                                    A_TENSION:$('#txtAverageOfTension').val(),  //22-5
                                    BEAM_TOTAL_WEIGHT:$('#txtBeamTotalWeight').val(),  //25-1
                                    REAL_DENIER:$('#txtActualDenier').val(),  //25-2
                                    LAST_DRAWING:$('#txtLastDrawing').val(),  //6-3

                                    L_RATIO_CONFIRMATION:$('#txtLengthRatioConfirmation').val(),  //25-4
                                    OR_REMARKS:$('#txtOrderRemarks').val(),  //26-1
                                    QU_REMARKS:$('#txtQualityRemarks').val(),  //27-1 
                                    CREATE_BY:'test',  //测试人员
                                    // CREATE_DATE:'2018-01-10', //
                                    CREATE_DATE:$('#txtQualityRemarks').val(),

                                    CONFIRMER:$('#txtConfirmer').val(),  //复选框input
                                    FINISH_MARK:0, //测试人员
                                    LOT_PRODUCTION_DATE:$('#txtLotProductionDate').val(),  //5-3
                                    rows:JSON.stringify(storagem),

                                    Beam_In_Use_Check:Beam_In_Use_Check,
                                    BEAM_NO_LIST:jobB.get().join(),
                                    //         
                                    username:sessionStorage.loginName
                                },
                                success:function(data){
                                    console.log(data)
                                    if(data){
                                        layer.alert(data.message, {
                                            title: "提示"
                                        });
                                    }
                                    storagem = [];
                                }
                            })
                        }else{
                            layer.alert('不可以报工', {
                                title: "提示"
                            });
                        }
                    }else{
                        layer.alert('无法报工', {
                            title: "提示"
                        });
                    }
                    layer.close(loading3)   //取消加载
                });

                //打印整經工單盤頭入倉單
                $("#stampSheet").click(function(){
                    if(count3<0.015||periphery3<0.015){
                        $.ajax({
                            url:getAjaxURL('/BeamWarpingConf/printGoodsReceipt'),
                            data:{
                                OrderNo:$("#inp").val()
                            },
                            success:function(data){
                                console.log(data)
                                if (data.status == 200) {
                                    // window.open(site_config.debug_url+data.data);
                                    window.open(data.data);
                                } else {
                                    layer.alert(data.message, {title: "提示"});
                                }
                            }
                        })
                    }
                });
                //打印整經盤頭票
                $("#stampTou").click(function(){
                    if(count3<0.015||periphery3<0.015){
                        $.ajax({
                            url:getAjaxURL('/BeamWarpingConf/printPrintBeamLabel'),
                            data:{
                                OrderNo:$("#inp").val()
                            },
                            success:function(data){
                                console.log(data)
                                if (data.status == 200) {
                                    // window.open(site_config.debug_url+data.data);
                                    window.open(data.data);
                                } else {
                                    layer.alert(data.message, {title: "提示"});
                                }
                            }
                        })
                    }
                });
            })
            
            

        </script>
        <script>
            // 是否是整数
            function isInteger(obj) {
             return typeof obj === 'number' && obj%1 === 0
            };
            function num(obj){
            obj.value = obj.value.replace(/[^\d.]/g,""); //清除"数字"和"."以外的字符
            obj.value = obj.value.replace(/^\./g,""); //验证第一个字符是数字
            obj.value = obj.value.replace(/\.{2,}/g,"."); //只保留第一个, 清除多余的
            obj.value = obj.value.replace(".","$#$").replace(/\./g,"").replace("$#$",".");
            obj.value = obj.value.replace(/^(\-)*(\d+)\.(\d\d).*$/,'$1$2.$3'); //只能输入两个小数
            };
            // 转时间格式
            function timestampToTime(timestamp) {
                var date = new Date(timestamp);//时间戳为10位需*1000，时间戳为13位的话不需乘1000
                Y = date.getFullYear() + '-';
                M = (date.getMonth()+1 < 10 ? '0'+(date.getMonth()+1) : date.getMonth()+1) + '-';
                D = date.getDate()<10? '0'+date.getDate() : date.getDate();
                return Y+M+D;
            };
            //js保留2位小数
            function returnFloat(value){
                // console.log(value);
                 var value=Math.round(parseFloat(value)*100)/100;
                 var xsd=value.toString().split(".");
                 if(xsd.length==1){
                 value=value.toString()+".00";
                 return value;
                 }
                 if(xsd.length>1){
                 if(xsd[1].length<2){
                 value=value.toString()+"0";
                 }
                 return value;
                 }
            }
        </script>
    </body>

</html>
<style scoped>
    .m{
        margin:0 15px;
    }
    *{
        margin: 0;
        padding: 0;
    }
    .top{
        height: 22px;
        line-height: 22px;
        font-size: 16px;
        border-bottom: 1px rgb(26,160,148) solid;
    }
    td{
        font-size: 12px;
        padding: 3px;
        width: 10%;
    }
    input{
        width: 100px;
    }
    .tdW{
        white-space:nowrap;
    }
    .tdW2{
        white-space:nowrap;
    }
    .tdW3{
        white-space:nowrap;
    }
    .tdW4{
        white-space:nowrap;
    }
    .layui-input{
        height: 20px!important;
    }
    .checkColor{
        background-color: white!important;
    }
</style>