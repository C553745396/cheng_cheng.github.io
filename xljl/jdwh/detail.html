<!doctype html>
<html>

	<head>
		<meta charset="UTF-8">
		<title>进度维护</title>
		<meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no" />
		<link href="css/mui.min.css" rel="stylesheet" />
		<link rel="stylesheet" href="css/style.css" />
		<link href="../public/style/slideBar.css" rel="stylesheet" type="text/css">
     	<script type="text/javascript" src="../public/js/jquery.js"></script>
		<script type="text/javascript" src="../cordova.js"></script>
		<script type="text/javascript" src="../public/js/public.js"></script>
    	<!--<script src="js/mui.min.js"></script>-->	
		<script src="../js/AJAX/prodBuild.js" type="text/javascript" charset="utf-8"></script>
		<script type="text/javascript" src="js/common2.js" ></script>
		<script type="text/javascript" src="../js/public/joint.js"></script>
	</head>
	<style>
		
		html,body{height:100%;width: 100%;}
		em{font-style: normal;}
		#bt{background: #02968A;margin-top: 10px;color: #FFFCF4;width: 150px;margin-left: 30%;}
		.mui-scroll-wrapper {
		    position: absolute;
		    z-index: 2;
		     top: 50px !important; 
		    bottom: 0;
		    left: 0;
		    overflow: hidden;
		    width: 100%;
		    overflow-y: auto;
		}
		.dd{
			position: absolute;
    		/*bottom: 266px;*/
    		margin-left: 48px;
    		height: 100px;
		}
		.xljl_header{height: 44px !important;}
		/*.mui-scroll-wrapper{z-index: 0;width:100%;}*/
		/*.xljl_header{position:absolute;z-index: 99999;}*/
		#detail_content ul{padding-left: 0px;position: relative;z-index: 999;}
		#detail_content{height: 100%;    height: 93%; position: absolute;bottom: 0px;top: 45px;overflow: auto;}
	</style>
	<body>
		<!--<div class="indexPage">-->
			<!--
        	作者：offline
        	时间：2017-06-24
        	描述：内容区域
        -->
			<div id="detail_content">
				<ul style="margin-top: 0px;">
					<li>计划开始时间：<span></span></li>
					<li>计划结束时间：<span></span></li>
					<li><em style="margin-left: 26px;">填写日期：</em><span id="text"/></span></li>
					<li><em style="margin-left: 10px;">进度百分比：</em><input type="text" id="text1"/>%</li>
					<li><span class="dd">备注：</span><textarea  cols="4" rows="8" id="textarea" autofocus></textarea></li>
					<!--<li style="height: 130px;position: fixed;left: 25%;bottom: 30px;"><button type="button" value="" id="bt">保存</button></li>-->
				</ul>
			<button type="button" value="" id="bt">保存</button>	
			</div>		
		<!--</div>	-->
		<script>
			//var currentdate,currenttime;
			
			/*全局*/	
			
			function onDeviceReady(){
				 var id = GetQueryString("data");												
				 //alert(id); 		    	
			     var jsonObj = eval('(' + data.data805.request + ')');
	            //jsonObj.head.roleName=roleName
	            jsonObj.data.ID=id;		            
	            var jsonStr = JSON.stringify(jsonObj);		            
	            data.data805.request = jsonStr;
	            getJSON(url, data.data805, data805);	
			}
			function data805(v){
			var data=v.data.cont[0];
			//alert("data"+data);
			$("#detail_content li span:eq(0)").text(data.PLAN_START_DATE);
			$("#detail_content li span:eq(1)").text(data.PLAN_END_DATE);
			$("#text").text(data.CREATE_DATE);					
			$("#text1").val(data.PERCENT_INFO);
			$("#textarea").text(data.NOTE_INFO);
			//getTime();
				
			}
			function updatedata(){
			/*	var starttime = $("#detail_content li span:eq(0)").val();
			var endtime = $("#detail_content li span:eq(1)").val();
				var time=$("#text").text();		*/	
				var id = GetQueryString("data");
				var curtime=$("#text").text();
				var proces=$("#text1").val();
				var tip=$("#textarea").text();					
				
				var proma= {					
					"process":proces,
					"tip":tip
				}
				//alert(proma)
				var jsonObj = eval('(' + data.data806.request + ')');
		            //jsonObj.head.roleName=roleName
		            jsonObj.data.ID=id;
		            jsonObj.data.OPETYPE="edit";
		            //jsonObj.data.=proma.starttime;
		            //jsonObj.data.endtime=proma.endtime;
		            jsonObj.data.CREATE_DATE=curtime;
		            jsonObj.data.PERCENT_INFO=proma.process;
		            jsonObj.data.NOTE_INFO=proma.tip;
		            var jsonStr = JSON.stringify(jsonObj);
		            
		            data.data806.request = jsonStr;
		            //alert(12121);
		            getJSON(url, data.data806, data806);	
			}
			function data806(v){
				
				//alert(v);
				if(v.data.success){
					 mui.alert("保存成功");
						window.location.href="index.html";
				} else {
		            mui.alert("保存失败");
		        }
				
			}
			
			function getTime() {
			   getNowFormatDate();
			   $("#text").text(currentdate);
			};

			function getNowFormatDate() {
			    var date = new Date();
			    var seperator = "-";		
			    var year = date.getFullYear();
			    var month = date.getMonth() + 1;
			    var strDate = date.getDate();			   
			    if(month >= 1 && month <= 9) {
			        month = "0" + month;
			    }

			    if(strDate >= 0 && strDate <= 9) {
			        strDate = "0" + strDate;
			    }
			    currentdate = year + seperator + month + seperator + strDate;

			}
			//调用接口
			

			$('#bt').click(function(){				
				updatedata();
			})

			var Aclick_img=document.getElementById('click_img');
			Aclick_img.onclick=function(){
				window.location.href="task1.html";
			}
				
		
		
		</script>	
	</body>

</html>